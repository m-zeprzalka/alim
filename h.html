<!DOCTYPE html>
<html lang="pl">
  <head>
    <meta charset="UTF-8" />
    <meta name="robots" content="noindex, nofollow">
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>AliMatrix - Formularz</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
      body {
        background: linear-gradient(135deg, #eaf1fb 0%, #dbeafe 100%);
        min-height: 100vh;
        font-family: 'Inter', Arial, sans-serif;
      }
      .step {
        display: none;
      }
      .step.active {
        display: block;
      }
      .slide-in {
        animation: slideIn 0.3s ease-out;
      }
      @keyframes slideIn {
        from { transform: translateY(40px); opacity: 0; }
        to { transform: translateY(0); opacity: 1; }
      }
      /* Progres bar */
      .progress-bar {
        transition: width 0.3s ease;
        height: 6px;
        border-radius: 3px;
      }
      /* Nowoczesne inputy */
      .modern-input {
        width: 100%;
        padding: 18px 20px;
        border-radius: 16px;
        border: none;
        background: #f1f5f9;
        font-size: 1.2rem;
        margin-bottom: 24px;
        box-shadow: 0 1px 2px rgba(0,0,0,0.03);
        outline: none;
        transition: box-shadow 0.2s;
      }
      .modern-input:focus {
        box-shadow: 0 0 0 2px #2563eb33;
      }
      /* Nowoczesny przycisk */
      .modern-btn {
        width: 100%;
        padding: 18px 0;
        border-radius: 16px;
        background: #1e293b;
        color: #fff;
        font-size: 1.25rem;
        font-weight: 600;
        border: none;
        margin-top: 8px;
        margin-bottom: 32px;
        transition: background 0.2s;
      }
      .modern-btn:active, .modern-btn:hover {
        background: #2563eb;
      }
      /* Branding/logo */
      .alimatrix-logo {
        display: flex;
        flex-direction: column;
        align-items: center;
        margin-top: 32px;
        margin-bottom: 8px;
      }
      .alimatrix-logo img {
        width: 48px;
        margin-bottom: 8px;
      }
      .alimatrix-logo .brand {
        font-size: 2rem;
        font-weight: 700;
        color: #1e293b;
        letter-spacing: -1px;
      }
      .alimatrix-logo .subtitle {
        font-size: 1rem;
        color: #64748b;
        font-weight: 500;
        letter-spacing: 0.5px;
      }
      /* Tooltip nowoczesny */
      .tooltip {
        position: relative;
        display: inline-block;
      }
      .tooltip .tooltiptext, .tooltip .tooltiptext-wide {
        visibility: hidden;
        position: fixed;
        left: 50%;
        top: 50%;
        transform: translate(-50%, -50%);
        background: #1e293b;
        color: #fff;
        border-radius: 16px;
        padding: 24px 20px 32px 20px;
        font-size: 1.1rem;
        max-width: 90vw;
        width: 340px;
        box-shadow: 0 8px 32px rgba(30,41,59,0.18);
        opacity: 0;
        transition: opacity 0.2s;
        text-align: left;
        word-break: break-word;
        z-index: 99999;
      }
      .tooltip .tooltiptext.active, .tooltip .tooltiptext-wide.active {
        visibility: visible;
        opacity: 1;
      }
      .tooltip .close-tooltip {
        position: absolute;
        top: 12px;
        right: 18px;
        font-size: 1.5rem;
        color: #fff;
        cursor: pointer;
      }
      .info-icon {
        display: inline-flex;
        align-items: center;
        justify-content: center;
        width: 28px;
        height: 28px;
        border-radius: 50%;
        background: #2563eb;
        color: #fff;
        font-weight: 700;
        font-size: 1.1rem;
        margin-left: 8px;
        cursor: pointer;
      }
      /* Custom checkbox/radio */
      .modern-check {
        appearance: none;
        width: 40px;
        height: 40px;
        border: 2px solid #cbd5e1;
        border-radius: 12px;
        background: #f1f5f9;
        margin-right: 16px;
        display: inline-block;
        vertical-align: middle;
        position: relative;
        transition: border 0.2s;
      }
      .modern-check:checked {
        border: 2px solid #2563eb;
        background: #2563eb;
      }
      .modern-check:checked:after {
        content: '';
        display: block;
        width: 18px;
        height: 18px;
        background: #fff;
        border-radius: 6px;
        position: absolute;
        top: 9px;
        left: 9px;
      }
      .modern-radio {
        appearance: none;
        width: 40px;
        height: 40px;
        border: 2px solid #cbd5e1;
        border-radius: 50%;
        background: #f1f5f9;
        margin-right: 16px;
        display: inline-block;
        vertical-align: middle;
        position: relative;
        transition: border 0.2s;
      }
      .modern-radio:checked {
        border: 2px solid #2563eb;
        background: #2563eb;
      }
      .modern-radio:checked:after {
        content: '';
        display: block;
        width: 16px;
        height: 16px;
        background: #fff;
        border-radius: 50%;
        position: absolute;
        top: 10px;
        left: 10px;
      }
      .modern-label {
        font-size: 1.15rem;
        font-weight: 500;
        color: #1e293b;
        display: flex;
        align-items: center;
        margin-bottom: 18px;
        cursor: pointer;
      }
      /* Tabela czasu opieki - mobile first */
      .care-table {
        width: 100%;
        border-collapse: separate;
        border-spacing: 0 8px;
        overflow-x: auto;
        display: block;
        font-size: 1.1rem;
      }
      .care-table th, .care-table td {
        min-width: 60px;
        padding: 8px 4px;
        text-align: center;
      }
      .care-table input[type="number"] {
        width: 48px;
        height: 48px;
        font-size: 1.1rem;
        border-radius: 12px;
        border: 1.5px solid #cbd5e1;
        background: #f1f5f9;
        text-align: center;
        margin: 0 auto;
      }
       /* Stylizacja suwaka dla rÃ³Å¼nych przeglÄ…darek */
  input[type=range] {
    -webkit-appearance: none;
    appearance: none;
    height: 10px;
    border-radius: 10px;
    background: #e2e8f0;
    outline: none;
  }
  
  input[type=range]::-webkit-slider-thumb {
    -webkit-appearance: none;
    appearance: none;
    width: 30px;
    height: 30px;
    border-radius: 50%;
    background: #2563eb;
    cursor: pointer;
    box-shadow: 0 2px 6px rgba(0,0,0,0.2);
  }
  
  input[type=range]::-moz-range-thumb {
    width: 30px;
    height: 30px;
    border-radius: 50%;
    background: #2563eb;
    cursor: pointer;
    border: none;
    box-shadow: 0 2px 6px rgba(0,0,0,0.2);
  }

  input[type=range]:focus {
    outline: none;
  }
  
  input[type=range]:focus::-webkit-slider-thumb {
    background: #1d4ed8;
    box-shadow: 0 0 0 3px rgba(37, 99, 235, 0.2);
  }
  
  input[type=range]:focus::-moz-range-thumb {
    background: #1d4ed8;
    box-shadow: 0 0 0 3px rgba(37, 99, 235, 0.2);
  }
      @media (max-width: 600px) {
        .care-table th, .care-table td {
          min-width: 44px;
          padding: 6px 2px;
        }
        .care-table input[type="number"] {
          width: 40px;
          height: 40px;
          font-size: 1rem;
        }
      }
      /* DuÅ¼e odstÄ™py sekcji */
      .section {
        margin-bottom: 48px;
      }
    </style>
  </head>
  <body className="bg-gray-50 min-h-screen">
    <!-- Progress bar -->
    <div className="fixed top-0 left-0 w-full h-1 bg-gray-200 z-50">
      <div
        id="progress"
        className="progress-bar h-full bg-blue-600"
        style="width: 0%"
      ></div>
    </div>

    <!-- Header -->
    <header className="bg-white shadow-sm sticky top-1 z-40">
      <div className="flex justify-center max-w-md mx-auto py-1 snap-center">
        <img src="assets/logo_AliMatrix_Mono.png" alt="AliMatrix" className="h-16">
      </div>
    </header>

    <!-- Main container -->
    <main className="max-w-md mx-auto px-4 py-6">
      <!-- Step 1: Welcome -->
      <div id="step-1" className="step active">
        <div className="bg-white rounded-lg shadow-sm p-6">
          <h2 className="text-2xl font-bold mb-4">
            AliMatrix. Alimenty bez tajemnic.
          </h2>
          <div className="space-y-4 text-gray-700">
            <p>
              <strong>AliMatrix</strong> to niezaleÅ¼na inicjatywa oparta na
              rzeczywistych danych. Pokazujemy, jak w praktyce rodzice w Polsce dzielÄ… siÄ™ kosztami
              utrzymania dzieci â€“ w rÃ³Å¼nych sytuacjach Å¼yciowych, rÃ³Å¼nych
              ukÅ‚adach opieki i rÃ³Å¼nych decyzjach sÄ…dowych. Chcemy, Å¼eby ustalenia dotyczÄ…ce alimentÃ³w byÅ‚y bardziej przejrzyste, a mniej zaleÅ¼ne od przypadku.
            </p>
            <p>
              RozwÃ³d, rozstanie, ustalanie sposobu finansowania potrzeb dziecka â€“ to momenty, ktÃ³re rodzÄ… wiele pytaÅ„ i niepewnoÅ›ci. W polskim systemie brakuje jasnych standardÃ³w, a decyzje sÄ…dowe czÄ™sto znaczÄ…co siÄ™ rÃ³Å¼niÄ…. AliMatrix powstaÅ‚ po to, by to zmieniÄ‡ â€“ przez analizÄ™ rzeczywistych przypadkÃ³w i budowÄ™ narzÄ™dzia opartego na danych, nie na opiniach.
            </p>
            <div className="bg-blue-50 p-4 rounded-lg">
              <p className="font-semibold mb-2">WypeÅ‚niajÄ…c ten formularz:</p>
              <ul className="list-disc list-inside space-y-1">
                <li>otrzymasz <strong>spersonalizowany raport</strong>, ktÃ³ry pokaÅ¼e, jak Twoja sytuacja wyglÄ…da na tle innych podobnych przypadkÃ³w (pierwsze 1000 osÃ³b â€“ bezpÅ‚atnie)</li>
                <li>
                  pomagasz stworzyÄ‡
                  <strong>pierwszÄ… w Polsce bazÄ™ danych alimentacyjnych</strong>, ktÃ³ra moÅ¼e realnie zmieniÄ‡ system
                </li>
                <li>
                  masz wpÅ‚yw na
                  <strong>wiÄ™kszÄ… przewidywalnoÅ›Ä‡ i uczciwoÅ›Ä‡</strong> w sprawach dotyczÄ…cych dzieci.
                </li>
              </ul>
            </div>
            <div className="bg-amber-50 p-4 rounded-lg">
              <p className="text-sm">
                <strong>Uwaga:</strong> obecnie zbieramy dane do stworzenia
                pierwszych raportÃ³w. Aby raporty byÅ‚y wiarygodne i naprawdÄ™ uÅ¼yteczne, potrzebujemy odpowiedniej liczby spÃ³jnych przypadkÃ³w. Po osiÄ…gniÄ™ciu wymaganej liczby odpowiedzi, przygotujemy i bezpÅ‚atnie udostÄ™pnimy raporty pierwszym 1000 osobom, ktÃ³re wypeÅ‚niÅ‚y formularz - DostÄ™p do raportÃ³w bÄ™dzie w przyszÅ‚oÅ›ci odpÅ‚atny. O postÄ™pach i gotowoÅ›ci raportu bÄ™dziemy CiÄ™ informowaÄ‡, jeÅ›li zdecydujesz siÄ™ zostawiÄ‡ swÃ³j adres e-mail.
              </p>
            </div>
            <p className="text-sm text-gray-600">
              Przewidywany czas wypeÅ‚nienia: okoÅ‚o 60 minut.
            </p>
            <p>
              To nie jest zwykÅ‚a ankieta â€“ to proces, ktÃ³ry moÅ¼e przynieÅ›Ä‡ wartoÅ›Ä‡ takÅ¼e Tobie. OdpowiadajÄ…c na pytania, byÄ‡ moÅ¼e lepiej zrozumiesz swojÄ… sytuacjÄ™, zobaczysz jÄ… w szerszym kontekÅ›cie i zyskasz wskazÃ³wki, ktÃ³re pomogÄ… w dalszych decyzjach. Twoje odpowiedzi z kolei pozwolÄ… AliMatrix tworzyÄ‡ trafniejsze estymacje â€“ zarÃ³wno dla Ciebie, jak i dla innych osÃ³b w podobnej sytuacji.
            </p>
            <p className="font-semibold mt-4">Formularz zostaÅ‚ podzielony na kilka przejrzystych czÄ™Å›ci:</p>
            <ul className="list-disc list-inside space-y-1 text-sm">
                <li>Informacje o dzieciach, na ktÃ³re ustalane sÄ… zasady finansowania potrzeb.</li>
                <li>Dochody, koszty Å¼ycia rodzicÃ³w i wydatki zwiÄ…zane z wychowaniem dzieci.</li>
                <li>Informacje o postÄ™powaniu sÄ…dowym dotyczÄ…cym Twojej sytuacji.</li>
                <li>Dane uÅ¼ytkownika potrzebne do bardziej miarodajnej analizy.</li>
            </ul>
            <p className="text-sm mt-2">
              Po zakoÅ„czeniu wypeÅ‚niania formularza poprosimy CiÄ™ o wyraÅ¼enie osobnej zgody na przetwarzanie danych w celu przygotowania spersonalizowanego raportu. JeÅ›li zdecydujesz siÄ™ podaÄ‡ adres eâ€‘mail, bÄ™dzie on przechowywany oddzielnie od pozostaÅ‚ych informacji. Twoje dane bÄ™dÄ… pseudonimizowane i nie bÄ™dÄ… powiÄ…zane z TwojÄ… toÅ¼samoÅ›ciÄ…. MoÅ¼esz je w kaÅ¼dej chwili edytowaÄ‡ lub usunÄ…Ä‡. Przetwarzamy je zgodnie z RODO, stosujÄ…c nowoczesne technologie ochrony prywatnoÅ›ci i bezpieczeÅ„stwa.
            </p>
             <p className="text-sm mt-2">
              Wiemy, Å¼e odpowiedzi na pytania dotyczÄ…ce sytuacji rodzinnej i finansowej mogÄ… wymagaÄ‡ chwili zastanowienia. Dlatego formularz zostaÅ‚ zaprojektowany tak, by automatycznie zapisywaÄ‡ Twoje postÄ™py. MoÅ¼esz wypeÅ‚niaÄ‡ go we wÅ‚asnym tempie â€“ wracaÄ‡ do wczeÅ›niejszych odpowiedzi, poprawiaÄ‡ je lub uzupeÅ‚niaÄ‡, kiedy bÄ™dziesz gotowy.
            </p>
            <p className="text-sm mt-2">
              DokÅ‚adne odpowiedzi pomogÄ… zbudowaÄ‡ obraz Twojej sytuacji tak, aby raport byÅ‚ dla Ciebie naprawdÄ™ uÅ¼ytecznym drogowskazem. KaÅ¼da precyzyjna informacja to krok ku wiÄ™kszej przejrzystoÅ›ci â€“ dla Ciebie i dla tych, ktÃ³rzy pÃ³jdÄ… Twoim Å›ladem.
            </p>
          </div>
          <div className="mt-6">
            <button
              onclick="nextStep()"
              className="w-full bg-blue-600 text-white py-3 px-4 rounded-lg font-semibold hover:bg-blue-700 transition"
            >
              Rozpocznij
            </button>
          </div>
        </div>
      </div>

      <!-- Step 2: Path selection -->
      <div id="step-2" className="step">
        <div className="bg-white rounded-lg shadow-sm p-6">
          <h2 className="text-xl font-bold mb-4">
            ğŸ” Na jakim etapie ustaleÅ„ dotyczÄ…cych finansowania potrzeb dziecka jesteÅ›?
          </h2>
          <p className="text-gray-700 mb-2">
            Zanim przejdziesz dalej, odpowiedz proszÄ™ na jedno pytanie:
          </p>
          <p className="text-gray-700 mb-4">
            Czy w Twojej sytuacji zostaÅ‚o juÅ¼ ustalone, w jaki sposÃ³b dzielicie
            siÄ™ z drugim rodzicem kosztami wychowania dziecka lub dzieci?
          </p>
          <p className="text-sm text-gray-600 mb-4">
            Takie ustalenia mogÄ… przyjmowaÄ‡ rÃ³Å¼ne formy:
            <ul className="list-disc list-inside text-sm ml-4 mb-2">
                <li>orzeczenie sÄ…du (np. postanowienie zabezpieczajÄ…ce, wyrok rozwodowy, zmiana wysokoÅ›ci alimentÃ³w),</li>
                <li>ugoda zawarta przed sÄ…dem lub mediatorem,</li>
                <li>prywatne porozumienie miÄ™dzy rodzicami,</li>
                <li>wspÃ³Å‚mierne dzielenie siÄ™ kosztami, bez formalnych przelewÃ³w.</li>
            </ul>
            W formularzu bÄ™dziemy uÅ¼ywaÄ‡ sÅ‚owa â€alimenty", poniewaÅ¼ takie okreÅ›lenie stosuje prawo i praktyka sÄ…dowa â€“ nawet jeÅ›li sposÃ³b finansowania potrzeb dziecka zostaÅ‚ ustalony inaczej, np. w wyniku porozumienia. NiezaleÅ¼nie od formy, chodzi o to samo: zapewnienie dziecku odpowiedniego wsparcia i zabezpieczenia jego potrzeb.
          </p>
          <p className="text-gray-700 mb-6 font-semibold">
            ğŸ“Œ Wybierz Å›cieÅ¼kÄ™, ktÃ³ra najlepiej opisuje TwojÄ… sytuacjÄ™:
          </p>
          <div className="space-y-4">
       <label className="block p-4 border-2 border-gray-200 rounded-lg cursor-pointer hover:border-blue-500 transition">
  <div className="flex items-start">
    <input
      type="radio"
      name="path"
      value="established"
      className="mr-3 mt-1"
      onchange="handlePathSelection(this)"
    />
    <div className="flex-1">
      <div className="flex items-center">
        <span className="font-semibold">Zasady finansowania potrzeb dziecka sÄ… juÅ¼ ustalone</span>
        <div className="tooltip ml-2" onclick="event.stopPropagation()">
          <span className="info-icon">i</span>
          <span className="tooltiptext-wide">Twoje odpowiedzi â€“ pseudonimizowane i przetwarzane zgodnie z RODO â€“ pomogÄ… lepiej zrozumieÄ‡, jak w praktyce wyglÄ…da finansowe wspieranie dzieci po rozstaniu rodzicÃ³w. JeÅ›li znajdziesz siÄ™ wÅ›rÃ³d pierwszych 1000 osÃ³b, ktÃ³re wypeÅ‚niÄ… formularz, otrzymasz bezpÅ‚atnie spersonalizowany raport. PokaÅ¼e on, jak Twoja sytuacja wyglÄ…da na tle innych przypadkÃ³w â€“ co moÅ¼e byÄ‡ pomocne, jeÅ›li zastanawiasz siÄ™, czy sposÃ³b finansowania potrzeb dziecka jest adekwatny, albo rozwaÅ¼asz kolejne kroki: prawne, negocjacyjne lub organizacyjne.</span>
        </div>
      </div>
      <p className="text-sm text-gray-600 mt-1">
        ChcÄ™ wypeÅ‚niÄ‡ formularz i podzieliÄ‡ siÄ™ informacjami o swojej sytuacji. â¡ï¸ JeÅ›li wybierzesz tÄ™ opcjÄ™, przejdziesz do peÅ‚nego formularza AliMatrix.
      </p>
    </div>
  </div>
</label>
            <label
              className="block p-4 border-2 border-gray-200 rounded-lg cursor-pointer hover:border-blue-500 transition"
            >
              <input
                type="radio"
                name="path"
                value="not-established"
                className="mr-3"
                onchange="handlePathSelection(this)"
              />
              <span className="font-semibold">Zasady finansowania potrzeb dziecka nie zostaÅ‚y jeszcze ustalone</span>
               <span className="tooltip">
                <span className="info-icon">i</span>
                <span className="tooltiptext-wide">Obecnie koncentrujemy siÄ™ na zebraniu informacji od osÃ³b, ktÃ³re juÅ¼ majÄ… ustalone zasady finansowego wsparcia dzieci. Na tej podstawie powstanÄ… pierwsze raporty, ktÃ³re udostÄ™pnimy takÅ¼e osobom w Twojej sytuacji. JeÅ›li chcesz otrzymaÄ‡ powiadomienie, gdy raporty bÄ™dÄ… gotowe â€“ moÅ¼esz zostawiÄ‡ swÃ³j adres e-mail. DziÄ™ki temu jako pierwszy(a) dowiesz siÄ™ o moÅ¼liwoÅ›ci skorzystania z wynikÃ³w analizy.</span>
              </span>
  
              <p className="text-sm text-gray-600 mt-1">
                ChciaÅ‚(a)bym dowiedzieÄ‡ siÄ™, jak to moÅ¼e wyglÄ…daÄ‡. â¡ï¸ JeÅ›li wybierzesz tÄ™ opcjÄ™, przekierujemy CiÄ™ do krÃ³tszego formularza zapisu na powiadomienie.
              </p>
            </label>
          </div>
          <div className="mt-6 flex gap-3">
            <button
              onclick="prevStep()"
              className="flex-1 bg-gray-200 text-gray-700 py-3 px-4 rounded-lg font-semibold hover:bg-gray-300 transition"
            >
              Wstecz
            </button>
            <button
              id="path-next"
              onclick="nextStep()"
              className="flex-1 bg-blue-600 text-white py-3 px-4 rounded-lg font-semibold hover:bg-blue-700 transition disabled:opacity-50"
              disabled
            >
              Dalej
            </button>
          </div>
        </div>
      </div>

      <!-- Step 3A: Main form - Financing method -->
      <div id="step-3a" className="step">
        <div className="bg-white rounded-lg shadow-sm p-6">
          <h2 className="text-xl font-bold mb-4">
            SposÃ³b finansowania potrzeb dziecka
            <span className="tooltip">
              <span className="info-icon">i</span>
              <span className="tooltiptext-wide">Pytamy o gÅ‚Ã³wne zasady finansowania potrzeb dziecka lub dzieci. Wiemy, Å¼e w praktyce sytuacje bywajÄ… rÃ³Å¼ne â€“ ale waÅ¼ne, Å¼eby istniaÅ‚ ustalony sposÃ³b dzielenia siÄ™ kosztami, nawet nieformalny. WskaÅ¼ odpowiedÅº, ktÃ³ra najlepiej oddaje WaszÄ… obecnÄ… sytuacjÄ™.</span>
            </span>
          </h2>
          <p className="text-gray-700 mb-6">
            Jak w Twojej sytuacji wyglÄ…da obecnie gÅ‚Ã³wne ustalenie dotyczÄ…ce
            finansowania potrzeb dziecka lub dzieci? (jeÅ›li masz wiÄ™cej niÅ¼ jedno dziecko, odpowiedz ogÃ³lnie â€“ w kolejnych pytaniach bÄ™dzie miejsce na szczegÃ³Å‚y)
          </p>
          <p className="text-gray-700 mb-2 font-semibold">Wybierz opcjÄ™, ktÃ³ra najlepiej oddaje TwojÄ… sytuacjÄ™:</p>
          <div className="space-y-3">
            <label
              className="block p-4 border-2 border-gray-200 rounded-lg cursor-pointer hover:border-blue-500 transition"
            >
              <input type="radio" name="financing" value="i-pay" className="mr-3" />
              <span className="font-semibold"
                >Ja regularnie przekazujÄ™ Å›rodki na utrzymanie dziecka/dzieci drugiemu rodzicowi</span
              >
              <p className="text-sm text-gray-600 mt-1">
                (np. alimenty lub inne uzgodnienia â€“ niezaleÅ¼nie od tego, czy ponoszÄ™ jeszcze inne koszty podczas opieki.)
              </p>
            </label>
            <label
              className="block p-4 border-2 border-gray-200 rounded-lg cursor-pointer hover:border-blue-500 transition"
            >
              <input
                type="radio"
                name="financing"
                value="i-receive"
                className="mr-3"
              />
              <span className="font-semibold"
                >Drugi rodzic regularnie przekazuje Å›rodki na utrzymanie dziecka/dzieci mnie</span
              >
              <p className="text-sm text-gray-600 mt-1">
                (nawet jeÅ›li takÅ¼e sam pokrywa niektÃ³re koszty podczas swojej opieki.)
              </p>
            </label>
            <label
              className="block p-4 border-2 border-gray-200 rounded-lg cursor-pointer hover:border-blue-500 transition"
            >
              <input
                type="radio"
                name="financing"
                value="shared"
                className="mr-3"
              />
              <span className="font-semibold"
                >Koszty utrzymania dzieci dzielimy w miarÄ™ proporcjonalnie, bez formalnego przekazywania pieniÄ™dzy miÄ™dzy sobÄ…</span
              >
              <p className="text-sm text-gray-600 mt-1">
                (KaÅ¼dy rodzic pokrywa swoje wydatki bezpoÅ›rednio lub finansujemy wspÃ³lnie w okreÅ›lony sposÃ³b.)
              </p>
            </label>
          </div>
          <div className="mt-6 flex gap-3">
            <button
              onclick="prevStep()"
              className="flex-1 bg-gray-200 text-gray-700 py-3 px-4 rounded-lg font-semibold hover:bg-gray-300 transition"
            >
              Wstecz
            </button>
            <button
              onclick="nextStep()"
              className="flex-1 bg-blue-600 text-white py-3 px-4 rounded-lg font-semibold hover:bg-blue-700 transition tooltip"
            >
              Dalej
              <span className="tooltiptext">Twoja odpowiedÅº pomoÅ¼e dostosowaÄ‡ dalsze pytania w formularzu do Twojej sytuacji. DziÄ™ki temu raport, ktÃ³ry otrzymasz, bÄ™dzie lepiej odzwierciedlaÅ‚ TwojÄ… rzeczywistoÅ›Ä‡.</span>
            </button>
          </div>
        </div>
      </div>

      <!-- Step 3B: Alternative path - email only -->
      <div id="step-3b" className="step">
        <div className="bg-white rounded-lg shadow-sm p-6">
          <h2 className="text-xl font-bold mb-4">
            ğŸ”µ Gdzie jesteÅ›my i jak moÅ¼emy Ci pomÃ³c
          </h2>
          <div className="space-y-4 text-gray-700">
            <p>DziÄ™kujemy za Twoje zainteresowanie AliMatrixem!</p>
            <p>
              Aktualnie koncentrujemy siÄ™ na zbieraniu danych od osÃ³b, ktÃ³re juÅ¼
              majÄ… ustalone zasady finansowego wspierania dzieci. DziÄ™ki temu wkrÃ³tce powstanÄ… pierwsze raporty dostÄ™pne takÅ¼e dla osÃ³b w Twojej sytuacji.
            </p>
            <p>
              TwÃ³j udziaÅ‚ i Twoje zainteresowanie majÄ… realne znaczenie â€“ im szybciej zbudujemy peÅ‚nÄ… bazÄ™ danych, tym szybciej stworzymy narzÄ™dzie, ktÃ³re pomoÅ¼e Ci lepiej oceniÄ‡ Twoje moÅ¼liwoÅ›ci i opcje.
            </p>
            <div className="bg-blue-50 p-4 rounded-lg">
              <p className="font-semibold mb-2">
                ğŸ“© Zostaw e-mail, aby otrzymaÄ‡ powiadomienie
              </p>
              <p>
                JeÅ›li chcesz otrzymaÄ‡ powiadomienie, gdy raporty dla Twojej
                sytuacji bÄ™dÄ… gotowe â€“ zostaw swÃ³j adres e-mail. â¡ï¸ DziÄ™ki temu jako pierwszy(a) dowiesz siÄ™ o moÅ¼liwoÅ›ci skorzystania z wynikÃ³w analizy.
              </p>
            </div>
            <div className="space-y-3">
              <label className="block">
                <span className="text-gray-700">Adres e-mail
                  <span className="tooltip">
                    <span className="info-icon">i</span>
                    <span className="tooltiptext-wide">TwÃ³j e-mail bÄ™dzie uÅ¼ywany wyÅ‚Ä…cznie do wysÅ‚ania Ci powiadomienia o gotowoÅ›ci raportÃ³w. Nie bÄ™dziemy przesyÅ‚aÄ‡ Å¼adnych reklam ani udostÄ™pniaÄ‡ Twojego adresu osobom trzecim. Dane kontaktowe przechowujemy oddzielnie od danych analitycznych, z zachowaniem zasad RODO.</span>
                  </span>
                </span>
                <input
                  type="email"
                  className="mt-1 block w-full rounded-lg border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500"
                  placeholder="twoj@email.pl"
                />
              </label>
              <label className="flex items-start">
                <input type="checkbox" className="mt-1 mr-3" />
                <span className="text-sm text-gray-600"
                  >WyraÅ¼am zgodÄ™ na przetwarzanie danych osobowych zgodnie z
                  RODO</span
                > <!-- TODO: Link to RODO policy -->
              </label>
            </div>
            <div className="bg-pink-50 p-4 rounded-lg">
              <p className="font-semibold mb-2">
                â¤ï¸ Chcesz dodatkowo wesprzeÄ‡ rozwÃ³j AliMatrixa?
              </p>
              <p className="text-sm mb-2">JeÅ›li masz ochotÄ™ â€“ moÅ¼esz rÃ³wnieÅ¼ pomÃ³c nam przyspieszyÄ‡ powstanie pierwszych raportÃ³w. KaÅ¼de wsparcie, nawet symboliczne, realnie wpÅ‚ywa na szybkoÅ›Ä‡ tworzenia narzÄ™dzia, ktÃ³re moÅ¼e zmieniÄ‡ sposÃ³b ustalania alimentÃ³w w Polsce.</p>
              <button
                className="mt-2 bg-pink-500 text-white py-2 px-4 rounded-lg hover:bg-pink-600 transition"
                onclick="window.open('https://zrzutka.pl', '_blank')"
              >
                â¡ï¸ PrzejdÅº do wsparcia na zrzutka.pl
              </button>
            </div>
            <p className="text-center font-semibold">DziÄ™kujemy, Å¼e jesteÅ› czÄ™Å›ciÄ… tej zmiany!</p>
          </div>
          <div className="mt-6 flex gap-3">
            <button
              onclick="prevStep()"
              className="flex-1 bg-gray-200 text-gray-700 py-3 px-4 rounded-lg font-semibold hover:bg-gray-300 transition"
            >
              Wstecz
            </button>
            <button
              onclick="finishAlternative()"
              className="flex-1 bg-blue-600 text-white py-3 px-4 rounded-lg font-semibold hover:bg-blue-700 transition"
            >
              Zapisz siÄ™
            </button>
          </div>
        </div>
      </div>

      <!-- Step 4: Legal basis -->
      <div id="step-4" className="step">
        <div className="bg-white rounded-lg shadow-sm p-6">
          <h2 className="text-xl font-bold mb-4">Podstawa ustaleÅ„
            <span className="tooltip">
                <span className="info-icon">i</span>
                <span className="tooltiptext-wide">Dlaczego o to pytamy? Typ ustaleÅ„ wpÅ‚ywa na trwaÅ‚oÅ›Ä‡ i pewnoÅ›Ä‡ sytuacji prawnej. Twoja odpowiedÅº pozwoli dopasowaÄ‡ dalsze pytania do Twojej sytuacji oraz zwiÄ™kszyÄ‡ precyzjÄ™ Twojego raportu.</span>
            </span>
          </h2>
          <p className="text-gray-700 mb-6">
            Na jakiej podstawie zostaÅ‚y ustalone zasady finansowania potrzeb
            dziecka lub dzieci? (Wybierz opcjÄ™, ktÃ³ra najlepiej oddaje TwojÄ… sytuacjÄ™.)
          </p>
          <div className="space-y-3">
            <label
              className="block p-3 border-2 border-gray-200 rounded-lg cursor-pointer hover:border-blue-500 transition"
            >
              <input
                type="radio"
                name="legal-basis"
                value="zabezpieczenie"
                className="mr-3"
              />
              <span>Postanowienie zabezpieczajÄ…ce</span>
              <p className="text-xs text-gray-500 ml-6">
                (tymczasowe ustalenie przez sÄ…d â€“ np. na czas trwania sprawy
                rozwodowej lub rodzinnej)
              </p>
            </label>
            <label
              className="block p-3 border-2 border-gray-200 rounded-lg cursor-pointer hover:border-blue-500 transition"
            >
              <input
                type="radio"
                name="legal-basis"
                value="wyrok"
                className="mr-3"
              />
              <span>Wyrok rozwodowy lub wyrok w innej sprawie rodzinnej</span>
              <p className="text-xs text-gray-500 ml-6">
                (ostateczne rozstrzygniÄ™cie sÄ…du o alimentach)
              </p>
            </label>
            <label
              className="block p-3 border-2 border-gray-200 rounded-lg cursor-pointer hover:border-blue-500 transition"
            >
              <input
                type="radio"
                name="legal-basis"
                value="ugoda-sad"
                className="mr-3"
              />
              <span>Porozumienie rodzicielskie zatwierdzone przez sÄ…d</span>
              <p className="text-xs text-gray-500 ml-6">
                (rodzice sami ustalili zasady, a sÄ…d je zatwierdziÅ‚ i nadaÅ‚ im moc prawnÄ…)
              </p>
            </label>
            <label
              className="block p-3 border-2 border-gray-200 rounded-lg cursor-pointer hover:border-blue-500 transition"
            >
              <input
                type="radio"
                name="legal-basis"
                value="mediacja"
                className="mr-3"
              />
              <span>Porozumienie mediacyjne</span>
              <p className="text-xs text-gray-500 ml-6">
                (ustalenia zawarte podczas mediacji â€“ z lub bez pÃ³Åºniejszego zatwierdzenia przez sÄ…d)
              </p>
            </label>
            <label
              className="block p-3 border-2 border-gray-200 rounded-lg cursor-pointer hover:border-blue-500 transition"
            >
              <input
                type="radio"
                name="legal-basis"
                value="prywatne"
                className="mr-3"
              />
              <span>Prywatne porozumienie bez zatwierdzenia przez sÄ…d</span>
              <p className="text-xs text-gray-500 ml-6">
                (uzgodnienia miÄ™dzy rodzicami, bez formalnej akceptacji sÄ…dowej)
              </p>
            </label>
            <label
              className="block p-3 border-2 border-gray-200 rounded-lg cursor-pointer hover:border-blue-500 transition"
            >
              <input
                type="radio"
                name="legal-basis"
                value="inne"
                className="mr-3"
                onchange="document.getElementById('legal-basis-inne-details').style.display = this.checked ? 'block' : 'none';"
              />
              <span>Inne</span>
            </label>
            <div id="legal-basis-inne-details" className="ml-6 mt-2" style="display: none;">
                <input type="text" className="w-full p-2 border border-gray-300 rounded-lg" placeholder="Prosimy o krÃ³tki opis">
            </div>
          </div>
          <div className="mt-6 flex gap-3">
            <button
              onclick="prevStep()"
              className="flex-1 bg-gray-200 text-gray-700 py-3 px-4 rounded-lg font-semibold hover:bg-gray-300 transition"
            >
              Wstecz
            </button>
            <button
              onclick="nextStep()"
              className="flex-1 bg-blue-600 text-white py-3 px-4 rounded-lg font-semibold hover:bg-blue-700 transition"
            >
              Dalej
            </button>
          </div>
        </div>
      </div>

      <!-- Step 5: Children info -->
      <div id="step-5" className="step">
        <div className="bg-white rounded-lg shadow-sm p-6">
          <h2 className="text-xl font-bold mb-4">Informacje o dzieciach</h2>
          <div className="text-gray-700 space-y-3 mb-6">
            <p>Ta czÄ™Å›Ä‡ formularza dotyczy dzieci, ktÃ³rych sytuacja alimentacyjna lub sposÃ³b dzielenia siÄ™ kosztami utrzymania zostaÅ‚a juÅ¼ w jakiÅ› sposÃ³b ustalona.</p>
            <p>W AliMatrix wierzymy, Å¼e rzetelna analiza zaczyna siÄ™ od zrozumienia konkretu â€“ a potrzeby dziecka sÄ… jednym z jego najwaÅ¼niejszych wymiarÃ³w. W kolejnych krokach poprosimy CiÄ™ o informacje, ktÃ³re pomogÄ… okreÅ›liÄ‡, jak wyglÄ…da Wasza codziennoÅ›Ä‡ â€“ opieka, czas spÄ™dzany z dzieckiem, jego wiek, edukacja oraz rzeczywiste wydatki.</p>
            <p>Te dane sÄ… nie tylko potrzebne do przygotowania raportu â€“ mogÄ… pomÃ³c rÃ³wnieÅ¼ Tobie, by lepiej zobaczyÄ‡ strukturÄ™ codziennoÅ›ci i odpowiedzialnoÅ›ci. Wiele osÃ³b dopiero w trakcie tego etapu uÅ›wiadamia sobie, jak naprawdÄ™ wyglÄ…da podziaÅ‚ czasu i kosztÃ³w zwiÄ…zanych z wychowaniem.</p>
          </div>
          <div className="space-y-4">
            <div>
              <label className="block text-gray-700 mb-2">Liczba dzieci: Ile dzieci objÄ™tych jest ustaleniami dotyczÄ…cymi alimentÃ³w lub wspÃ³Å‚finansowania kosztÃ³w Å¼ycia?
                <span className="tooltip">
                  <span className="info-icon">i</span>
                  <span className="tooltiptext-wide">Wybierz liczbÄ™ dzieci, dla ktÃ³rych chcesz wypeÅ‚niÄ‡ formularz. KaÅ¼de dziecko bÄ™dzie miaÅ‚o osobny zestaw pytaÅ„.</span>
                </span>
              </label>
              <select className="w-full p-3 border-2 border-gray-200 rounded-lg" onchange="generateChildForms(this.value)">
                <option value="">Wybierz...</option>
                <option value="1">1 dziecko</option>
                <option value="2">2 dzieci</option>
                <option value="3">3 dzieci</option>
                <option value="4">4 dzieci</option>
                <option value="5">5+ dzieci</option>
              </select>
              <br>
              &nbsp;
<span className="tooltip">
                  <span className="info-icon">i</span>
                  <span className="tooltiptext-wide">Twoja odpowiedÅº pomoÅ¼e dostosowaÄ‡ dalsze pytania w formularzu do Twojej sytuacji.
DziÄ™ki temu raport, ktÃ³ry otrzymasz, bÄ™dzie lepiej odzwierciedlaÅ‚ TwojÄ… rzeczywistoÅ›Ä‡.
</span>
                </span>
            </div>
            <div id="children-forms" className="space-y-6">
              <!-- Child forms will be generated here -->
            </div>
          </div>
          <div className="mt-6 flex gap-3">
            <button
              onclick="prevStep()"
              className="flex-1 bg-gray-200 text-gray-700 py-3 px-4 rounded-lg font-semibold hover:bg-gray-300 transition"
            >
              Wstecz
            </button>
            <button
              onclick="nextStep()"
              className="flex-1 bg-blue-600 text-white py-3 px-4 rounded-lg font-semibold hover:bg-blue-700 transition"
            >
              Dalej
            </button>
          </div>
        </div>
      </div>

      <!-- Step 6: Care time -->
      <div id="step-6" className="step">
        <div className="bg-white rounded-lg shadow-sm p-6">
          <h2 className="text-xl font-bold mb-4">Czas opieki</h2>
           <div className="text-gray-700 space-y-3 mb-4">
                <p>PamiÄ™taj, Å¼e w tej sekcji bÄ™dziemy zbieraÄ‡ informacje o opiece nad dzieckiem i czasie, jaki spÄ™dzasz z nim w danym okresie. Aby obliczenia byÅ‚y precyzyjne, prosimy o wpisanie czasu spÄ™dzanego z dzieckiem w poszczegÃ³lnych dniach. KaÅ¼da godzina ma znaczenie â€“ pamiÄ™taj, Å¼e noc przypisujemy do dnia, w ktÃ³rym dziecko zasnÄ™Å‚o. Proces wypeÅ‚niania tej sekcji moÅ¼e zajÄ…Ä‡ kilka minut, ale wierzymy, Å¼e pomoÅ¼e Ci to lepiej zrozumieÄ‡, jak wyglÄ…da podziaÅ‚ opieki i jak zÅ‚oÅ¼ona jest kwestia alimentÃ³w.</p>
           </div>
          <p className="text-gray-700 mb-4">
            OkreÅ›lenie czasu opieki nad dzieckiem (przykÅ‚ad dla pierwszego
            dziecka).
          </p>
          <div className="bg-blue-50 p-4 rounded-lg mb-6">
            <p className="text-sm font-semibold">Zanim zaczniesz: kilka sÅ‚Ã³w od nas.</p>
            <p className="text-sm">
              Ta czÄ™Å›Ä‡ moÅ¼e zajÄ…Ä‡ chwilÄ™ â€“ ale kaÅ¼da minuta ma sens. WypeÅ‚niajÄ…c
              tÄ™ sekcjÄ™, nie tylko dostarczasz danych do raportu. Masz szansÄ™
              przyjrzeÄ‡ siÄ™ uwaÅ¼nie codziennoÅ›ci â€“ czasowi, ktÃ³ry naprawdÄ™ spÄ™dzasz z dzieckiem, i temu, jak wyglÄ…da Wasz rytm tygodnia.
            </p>
            <p className="text-sm mt-2">ğŸ§  To moÅ¼e byÄ‡ moment refleksji â€“ i bardzo czÄ™sto jest.</p>
          </div>
          <div className="bg-amber-50 p-4 rounded-lg mb-6">
            <p className="text-sm font-semibold">ğŸ“Œ Uwaga techniczna:</p>
            <ul className="list-disc list-inside text-sm space-y-1">
                <li>WypeÅ‚niasz tylko czas, kiedy dziecko jest z TobÄ….</li>
                <li>Sen przypisujemy do dnia, w ktÃ³rym dziecko zasnÄ™Å‚o.</li>
                <li>JeÅ›li dziecko chodzi do szkoÅ‚y lub przedszkola, podaj liczbÄ™ godzin w placÃ³wce.</li>
                <li>PozostaÅ‚e godziny formularz przypisze automatycznie drugiemu rodzicowi.</li>
            </ul>
          </div>
          <div className="space-y-4">
            <label className="block">
              <span className="text-gray-700">Cykl opieki</span>
              <select
                className="mt-1 w-full p-3 border-2 border-gray-200 rounded-lg"
                id="care-cycle"
              >
                <option value="1">Co tydzieÅ„</option>
                <option value="2">Co 2 tygodnie</option>
                <option value="4">Co 4 tygodnie (np. ukÅ‚ad miesiÄ™czny)</option>
                <option value="custom">Brak staÅ‚ego schematu â€“ uÅ›rednimy dane do 4-tygodniowego cyklu</option>
              </select>
              <p className="text-xs text-gray-500 mt-1">JeÅ›li wybierzesz "Brak staÅ‚ego schematu", podaj dane dla przykÅ‚adowych 4 tygodni, Å¼eby ustandaryzowaÄ‡ analizÄ™.</p>
            </label>
            
            <div className="text-gray-700 space-y-3 my-4 p-3 bg-gray-100 rounded-md">
                <p className="font-semibold">WskazÃ³wki do wypeÅ‚niania tabeli:</p>
                <p>Przy wypeÅ‚nianiu tabeli pamiÄ™taj, Å¼e wpisujesz czas, jaki spÄ™dzasz z dzieckiem. Wpisuj peÅ‚ne godziny od momentu w ktÃ³rym zaczynasz opiekÄ™ nad dzieckiem w danym dniu, aÅ¼ do momentu zakoÅ„czenia, pamiÄ™taj, Å¼e noc przypisujemy do dnia, w ktÃ³rym dziecko zasnÄ™Å‚o. PamiÄ™taj, aby wprowadziÄ‡ godziny, w ktÃ³rych dziecko jest pod TwojÄ… opiekÄ…. JeÅ›li dziecko jest w placÃ³wce edukacyjnej, wpisz czas, ktÃ³ry tam spÄ™dza. JeÅ›li dziecko Å›pi, wybierz odpowiedniÄ… kolumnÄ™ â€“ 'Sen u Ciebie' lub 'Sen u drugiego rodzica'. System automatycznie przypisze pozostaÅ‚y czas drugiemu rodzicowi. Czas wypeÅ‚nienia formularza zajmie okoÅ‚o 10-15 minut. PamiÄ™taj, Å¼e zawsze moÅ¼esz wrÃ³ciÄ‡ do poprzednich sekcji i skorygowaÄ‡ swoje odpowiedzi. Z gÃ³ry dziÄ™kujemy za poÅ›wiÄ™cony czas â€“ dziÄ™ki temu Twoje dane bÄ™dÄ… precyzyjnie odzwierciedlaÄ‡ sytuacjÄ™, co pozwoli nam stworzyÄ‡ dokÅ‚adny raport a Ty uzyskasz wiedzÄ™ o podziale procentowym czasu opieki w rÃ³Å¼nych aspektach.</p>
            </div>

            <!-- Time table for care cycle -->
            <div className="overflow-x-auto">
              <table className="w-full text-sm care-table">
                <thead>
                  <tr className="border-b">
                    <th className="p-2 text-left">Czas</th>
                    <th className="p-2">Pn</th>
                    <th className="p-2">Wt</th>
                    <th className="p-2">Åšr</th>
                    <th className="p-2">Cz</th>
                    <th className="p-2">Pt</th>
                    <th className="p-2">Sb</th>
                    <th className="p-2">Nd</th>
                  </tr>
                </thead>
                <tbody>
                  <tr className="border-b">
                    <td className="p-2">Poranek
                        <span className="tooltip"><span className="info-icon">i</span><span className="tooltiptext">Godziny, w ktÃ³rych rodzic ma opiekÄ™ nad dzieckiem rano (np. od momentu wstania do wyjÅ›cia z domu).</span></span>
                    </td>
                    <!-- Input fields for each day -->
                    <td className="p-2"><input type="number" className="w-12 p-1 border rounded" placeholder="0" min="0" max="24"/></td>
                    <td className="p-2"><input type="number" className="w-12 p-1 border rounded" placeholder="0" min="0" max="24"/></td>
                    <td className="p-2"><input type="number" className="w-12 p-1 border rounded" placeholder="0" min="0" max="24"/></td>
                    <td className="p-2"><input type="number" className="w-12 p-1 border rounded" placeholder="0" min="0" max="24"/></td>
                    <td className="p-2"><input type="number" className="w-12 p-1 border rounded" placeholder="0" min="0" max="24"/></td>
                    <td className="p-2"><input type="number" className="w-12 p-1 border rounded" placeholder="0" min="0" max="24"/></td>
                    <td className="p-2"><input type="number" className="w-12 p-1 border rounded" placeholder="0" min="0" max="24"/></td>
                  </tr>
                  <tr className="border-b">
                    <td className="p-2">PlacÃ³wka edukacyjna
                        <span className="tooltip"><span className="info-icon">i</span><span className="tooltiptext">Czas, ktÃ³ry dziecko spÄ™dza w placÃ³wce edukacyjnej (np. szkoÅ‚a, przedszkole, Å¼Å‚obek). Tutaj uÅ¼ytkownik wpisuje liczbÄ™ godzin.</span></span>
                    </td>
                    <td className="p-2"><input type="number" className="w-12 p-1 border rounded" placeholder="0" min="0" max="24"/></td>
                    <td className="p-2"><input type="number" className="w-12 p-1 border rounded" placeholder="0" min="0" max="24"/></td>
                    <td className="p-2"><input type="number" className="w-12 p-1 border rounded" placeholder="0" min="0" max="24"/></td>
                    <td className="p-2"><input type="number" className="w-12 p-1 border rounded" placeholder="0" min="0" max="24"/></td>
                    <td className="p-2"><input type="number" className="w-12 p-1 border rounded" placeholder="0" min="0" max="24"/></td>
                    <td className="p-2"><input type="number" className="w-12 p-1 border rounded" placeholder="0" min="0" max="24"/></td>
                    <td className="p-2"><input type="number" className="w-12 p-1 border rounded" placeholder="0" min="0" max="24"/></td>
                  </tr>
                  <tr className="border-b">
                    <td className="p-2">Czas po edukacji
                         <span className="tooltip"><span className="info-icon">i</span><span className="tooltiptext">Czas spÄ™dzany z dzieckiem po powrocie z placÃ³wki edukacyjnej (np. zabawa, zajÄ™cia w domu).</span></span>
                    </td>
                    <td className="p-2"><input type="number" className="w-12 p-1 border rounded" placeholder="0" min="0" max="24"/></td>
                    <td className="p-2"><input type="number" className="w-12 p-1 border rounded" placeholder="0" min="0" max="24"/></td>
                    <td className="p-2"><input type="number" className="w-12 p-1 border rounded" placeholder="0" min="0" max="24"/></td>
                    <td className="p-2"><input type="number" className="w-12 p-1 border rounded" placeholder="0" min="0" max="24"/></td>
                    <td className="p-2"><input type="number" className="w-12 p-1 border rounded" placeholder="0" min="0" max="24"/></td>
                    <td className="p-2"><input type="number" className="w-12 p-1 border rounded" placeholder="0" min="0" max="24"/></td>
                    <td className="p-2"><input type="number" className="w-12 p-1 border rounded" placeholder="0" min="0" max="24"/></td>
                  </tr>
                  <tr className="border-b">
                    <td className="p-2">Sen u Ciebie
                        <span className="tooltip"><span className="info-icon">i</span><span className="tooltiptext">Czas, ktÃ³ry dziecko spÄ™dza na spaniu, gdy jest pod TwojÄ… opiekÄ….</span></span>
                    </td>
                    <td className="p-2"><input type="number" className="w-12 p-1 border rounded" placeholder="0" min="0" max="24"/></td>
                    <td className="p-2"><input type="number" className="w-12 p-1 border rounded" placeholder="0" min="0" max="24"/></td>
                    <td className="p-2"><input type="number" className="w-12 p-1 border rounded" placeholder="0" min="0" max="24"/></td>
                    <td className="p-2"><input type="number" className="w-12 p-1 border rounded" placeholder="0" min="0" max="24"/></td>
                    <td className="p-2"><input type="number" className="w-12 p-1 border rounded" placeholder="0" min="0" max="24"/></td>
                    <td className="p-2"><input type="number" className="w-12 p-1 border rounded" placeholder="0" min="0" max="24"/></td>
                    <td className="p-2"><input type="number" className="w-12 p-1 border rounded" placeholder="0" min="0" max="24"/></td>
                  </tr>
                  <tr>
                    <td className="p-2">Sen u drugiego rodzica
                        <span className="tooltip"><span className="info-icon">i</span><span className="tooltiptext">Czas, ktÃ³ry dziecko spÄ™dza na spaniu, gdy jest pod opiekÄ… drugiego rodzica.</span></span>
                    </td>
                    <td className="p-2"><input type="number" className="w-12 p-1 border rounded" placeholder="0" min="0" max="24"/></td>
                    <td className="p-2"><input type="number" className="w-12 p-1 border rounded" placeholder="0" min="0" max="24"/></td>
                    <td className="p-2"><input type="number" className="w-12 p-1 border rounded" placeholder="0" min="0" max="24"/></td>
                    <td className="p-2"><input type="number" className="w-12 p-1 border rounded" placeholder="0" min="0" max="24"/></td>
                    <td className="p-2"><input type="number" className="w-12 p-1 border rounded" placeholder="0" min="0" max="24"/></td>
                    <td className="p-2"><input type="number" className="w-12 p-1 border rounded" placeholder="0" min="0" max="24"/></td>
                    <td className="p-2"><input type="number" className="w-12 p-1 border rounded" placeholder="0" min="0" max="24"/></td>
                  </tr>
                </tbody>
              </table>
            </div>
             <p className="text-xs text-gray-500 mt-2">System automatycznie przypisze godziny do drugiego rodzica, uwzglÄ™dniajÄ…c rÃ³Å¼nicÄ™ miÄ™dzy czasem snu u jednego i drugiego rodzica.</p>
             <p className="text-xs text-gray-500 mt-1">Ta tabela powinna byÄ‡ wyÅ›wietlona tyle razy ile zostanie podane jako cykl opieki (np. 2 razy dla cyklu "Co 2 tygodnie") i pÃ³Åºniej siÄ™ zsumowaÄ‡ do %: udziaÅ‚ Twojego czasu w total bez placÃ³wki edukacyjnej, udziaÅ‚ Twojego czasu bez placÃ³wki edukacyjnej i bez czasu snu dziecka. (Logika do implementacji w JS)</p>
          </div>
          <div className="mt-6 flex gap-3">
            <button
              onclick="prevStep()"
              className="flex-1 bg-gray-200 text-gray-700 py-3 px-4 rounded-lg font-semibold hover:bg-gray-300 transition"
            >
              Wstecz
            </button>
            <button
              onclick="nextStep()"
              className="flex-1 bg-blue-600 text-white py-3 px-4 rounded-lg font-semibold hover:bg-blue-700 transition"
            >
              Dalej
            </button>
          </div>
        </div>
      </div>

      <!-- Step 7: Costs -->
      <div id="step-7" className="step">
          <div className="bg-white rounded-lg shadow-sm p-6">
          <h2 className="text-2xl font-bold mb-6">Koszty utrzymania dziecka</h2>
          <p className="text-gray-700 mb-6">
            Nie po to, by je oceniaÄ‡. Pytamy, by lepiej zrozumieÄ‡ rzeczywiste potrzeby dzieci w rÃ³Å¼nych sytuacjach Å¼yciowych â€“ 
            i daÄ‡ Ci dane, ktÃ³re moÅ¼esz wykorzystaÄ‡ w rozmowach, negocjacjach lub przed sÄ…dem.
          </p>
          <p className="text-gray-700 mb-6">
            ğŸ“Œ JeÅ›li masz wydatki roczne (np. wakacje, sprzÄ™t sportowy), podziel je przez 12 i podaj uÅ›rednionÄ… miesiÄ™cznÄ… kwotÄ™.
          </p>

          <div className="space-y-6">
            <div>
              <label className="block text-gray-700 mb-2">Kwota alimentÃ³w</label>
              <input type="number" className="w-full p-3 border-2 border-gray-200 rounded-lg" 
                     placeholder="0" min="0" step="0.01" required>
              <p className="text-sm text-gray-500 mt-1">Jaka kwota zostaÅ‚a ustalona jako alimenty na to dziecko (przez sÄ…d lub w porozumieniu)?</p>
            </div>

            <div>
              <label className="block text-gray-700 mb-2">Twoje miesiÄ™czne wydatki na dziecko</label>
              <input type="number" className="w-full p-3 border-2 border-gray-200 rounded-lg" 
                     placeholder="0" min="0" step="0.01" required>
              <p className="text-sm text-gray-500 mt-1">JakÄ… Å›redniÄ… miesiÄ™cznÄ… kwotÄ™ przeznaczasz na potrzeby dziecka?</p>
            </div>

            <div>
              <label className="block text-gray-700 mb-2">Wydatki drugiego rodzica (jeÅ›li znane)</label>
              <input type="number" className="w-full p-3 border-2 border-gray-200 rounded-lg" 
                     placeholder="0" min="0" step="0.01">
              <p className="text-sm text-gray-500 mt-1">JakÄ… kwotÄ™ miesiÄ™cznie przeznacza na dziecko drugi rodzic?</p>
            </div>

            <div>
              <label className="block text-gray-700 mb-2">Koszty uznane przez sÄ…d (jeÅ›li dotyczy)</label>
              <input type="number" className="w-full p-3 border-2 border-gray-200 rounded-lg" 
                     placeholder="0" min="0" step="0.01">
              <p className="text-sm text-gray-500 mt-1">JakÄ… miesiÄ™cznÄ… kwotÄ™ jako koszt utrzymania dziecka wskazaÅ‚ sÄ…d w swoim postanowieniu?</p>
            </div>

            <div>
              <label className="block text-gray-700 mb-2">Inne ÅºrÃ³dÅ‚a utrzymania dziecka</label>
              <div className="space-y-2">
              <label className="flex items-center">
                  <input type="checkbox" className="mr-2">
                  Renta rodzinna
              </label>
              <label className="flex items-center">
                  <input type="checkbox" className="mr-2">
                  Åšwiadczenie pielÄ™gnacyjne
              </label>
              <label className="flex items-center">
                  <input type="checkbox" className="mr-2">
                  Inne
                  <input type="text" className="ml-2 p-2 border rounded" placeholder="ProszÄ™ podaÄ‡">
              </label>
              <label className="flex items-center">
                  <input type="checkbox" className="mr-2">
                  Brak dodatkowych ÅºrÃ³deÅ‚
              </label>
            </div>
          </div>
          </div>
                </div>
            
          <div className="mt-8 flex justify-between">
            <button onclick="prevStep()" className="px-6 py-3 bg-gray-200 text-gray-800 rounded-lg hover:bg-gray-300">
              Wstecz
            </button>
            <button onclick="nextStep()" className="px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700">
              Dalej
            </button>
          </div>
        </div>
      </div>

      <!-- Step 8: Income -->
      <div id="step-8" className="step">
        <div className="bg-white rounded-lg shadow-sm p-6">
          <h2 className="text-xl font-bold mb-4">
            Dochody i koszty Å¼ycia rodzicÃ³w
          </h2>
          <div className="text-gray-700 space-y-2 mb-6">
            <p>To nie test ani osÄ…d â€“ to analiza, ktÃ³ra ma pomÃ³c lepiej zrozumieÄ‡ sytuacjÄ™.</p>
            <p>Im dokÅ‚adniejsze bÄ™dÄ… Twoje dane, tym trafniejszy bÄ™dzie raport â€“ zarÃ³wno dla Ciebie, jak i innych osÃ³b w podobnej sytuacji.</p>
            <p>ZadbaliÅ›my o to, Å¼eby pytania byÅ‚y zrozumiaÅ‚e, a formularz prowadziÅ‚ CiÄ™ krok po kroku. Dla wielu osÃ³b ta czÄ™Å›Ä‡ formularza bywa teÅ¼ momentem refleksji nad tym, jak naprawdÄ™ wyglÄ…da ich codziennoÅ›Ä‡ finansowa.</p>
          </div>

          <div className="mb-6">
            <h3 className="text-lg font-semibold mb-3">Twoje dochody</h3>
            <div className="space-y-4">
              <div>
                <label className="block text-gray-700 mb-1"
                  >Oficjalne dochody netto (miesiÄ™cznie)</label
                >
                <p className="text-xs text-gray-500 mb-2">Podaj swoje oficjalne dochody netto z ostatnich 12 miesiÄ™cy PRZED ustanowieniem alimentÃ³w â€“ Å›redniÄ… miesiÄ™cznÄ… kwotÄ™, obejmujÄ…cÄ…: wynagrodzenia z umÃ³w o pracÄ™, zlecenie, dzieÅ‚o; przychody z dziaÅ‚alnoÅ›ci gospodarczej; inne powtarzalne ÅºrÃ³dÅ‚a dochodu. Uwaga: JeÅ›li Twoje dochody sÄ… sezonowe (np. premia roczna, sprzedaÅ¼ usÅ‚ug w okreÅ›lonym okresie roku), prosimy o uwzglÄ™dnienie tych wahaÅ„ â€“ podaj uÅ›rednionÄ… wartoÅ›Ä‡ miesiÄ™cznÄ….</p>
                <input
                  type="number"
                  className="w-full p-3 border-2 border-gray-200 rounded-lg"
                  placeholder="0 zÅ‚"
                />
              </div>
              <div>
                <label className="block text-gray-700 mb-1"
                  >PotencjaÅ‚ dochodowy (miesiÄ™cznie)
                  <span className="tooltip">
                    <span className="info-icon">i</span>
                    <span className="tooltiptext-wide">JeÅ›li prowadzisz dziaÅ‚alnoÅ›Ä‡ i czÄ™Å›Ä‡ kosztÃ³w firmowych (np. leasing, paliwo, telefon) dotyczy takÅ¼e Å¼ycia prywatnego â€“ oszacuj ich wartoÅ›Ä‡ i uwzglÄ™dnij proporcjonalnie w swoich kosztach Å¼ycia, a nie jako czystÄ… stratÄ™ firmowÄ….</span>
                  </span>
                </label>
                <p className="text-xs text-gray-500 mb-2">Nie zawsze dochody pokazujÄ… peÅ‚en obraz. SÄ…d â€“ a my w raporcie rÃ³wnieÅ¼ â€“ bierze pod uwagÄ™ Twoje moÅ¼liwoÅ›ci zarobkowe. W tej czÄ™Å›ci prosimy o oszacowanie: ile realnie mÃ³gÅ‚byÅ›/mogÅ‚abyÅ› zarabiaÄ‡ przy uwzglÄ™dnieniu Twojego wyksztaÅ‚cenia, doÅ›wiadczenia, branÅ¼y, dostÄ™pnoÅ›ci ofert pracy; w przypadku dziaÅ‚alnoÅ›ci gospodarczej: jaka jest realna moÅ¼liwoÅ›Ä‡ zwiÄ™kszenia dochodu (np. wzrost marÅ¼y, wykorzystanie peÅ‚nego czasu pracy, ograniczenie kosztÃ³w).</p>
                <input
                  type="number"
                  className="w-full p-3 border-2 border-gray-200 rounded-lg"
                  placeholder="0 zÅ‚"
                />
              </div>
            </div>
          </div>
          <div className="mb-6">
            <h3 className="text-lg font-semibold mb-3">Twoje koszty Å¼ycia i zobowiÄ…zania</h3>
            <div className="space-y-4">
              <div>
                <label className="block text-gray-700 mb-1"
                  >Koszty utrzymania siebie (miesiÄ™cznie)</label
                >
                <p className="text-xs text-gray-500 mb-2">Podaj kwotÄ™ miesiÄ™cznych wydatkÃ³w na: Å¼ywnoÅ›Ä‡, mieszkanie, media, transport, leki, ubezpieczenia, inne staÅ‚e koszty zwiÄ…zane z codziennym funkcjonowaniem.</p>
                <input
                  type="number"
                  className="w-full p-3 border-2 border-gray-200 rounded-lg"
                  placeholder="0 zÅ‚"
                />
              </div>
              <div>
                <label className="block text-gray-700 mb-1"
                  >Koszty utrzymania innych osÃ³b (miesiÄ™cznie)</label
                >
                <p className="text-xs text-gray-500 mb-2">JeÅ›li wspierasz finansowo inne osoby (np. dzieci z poprzedniego zwiÄ…zku, partnera/partnerkÄ™, rodzicÃ³w), wskaÅ¼ ich Å‚Ä…czny koszt miesiÄ™czny.</p>
                <input
                  type="number"
                  className="w-full p-3 border-2 border-gray-200 rounded-lg"
                  placeholder="0 zÅ‚"
                />
              </div>
              <div>
                <label className="block text-gray-700 mb-1"
                  >Dodatkowe zobowiÄ…zania (miesiÄ™cznie)</label
                >
                <p className="text-xs text-gray-500 mb-2">Podaj wysokoÅ›Ä‡ wszystkich miesiÄ™cznych obciÄ…Å¼eÅ„ finansowych: kredyty, raty, poÅ¼yczki, alimenty na inne dzieci, inne regularne pÅ‚atnoÅ›ci (np. windykacje, kary umowne).</p>
                <input
                  type="number"
                  className="w-full p-3 border-2 border-gray-200 rounded-lg"
                  placeholder="0 zÅ‚"
                />
              </div>
              <p className="text-xs text-gray-600 bg-gray-100 p-2 rounded">Uwaga techniczna: Nie uwzglÄ™dniaj tych samych kosztÃ³w dwa razy â€“ np. jeÅ›li leasing pojazdu rozliczasz w firmie, nie wpisuj go ponownie jako koszt Å¼ycia osobistego.</p>
            </div>
          </div>

          <div className="mb-6">
            <h3 className="text-lg font-semibold mb-3">Dochody i koszty drugiego rodzica</h3>
            <p className="text-sm text-gray-600 mb-4">JeÅ›li posiadasz informacje na temat sytuacji drugiego rodzica, podaj je w analogiczny sposÃ³b. Nie masz pewnoÅ›ci? Wpisz â€nd" (nie dotyczy / nieznane) w polach tekstowych lub pozostaw pola liczbowe puste/0 â€“ formularz nadal zostanie prawidÅ‚owo przetworzony.</p>
            
            <h4 className="text-md font-semibold mt-4 mb-2 text-gray-800">Dochody drugiego rodzica</h4>
            <div className="space-y-4">
              <div>
                <label className="block text-gray-700 mb-1">Oficjalne dochody netto drugiego rodzica (miesiÄ™cznie)</label>
                <p className="text-xs text-gray-500 mb-2">Åšrednia miesiÄ™czna kwota.</p>
                <input type="number" className="w-full p-3 border-2 border-gray-200 rounded-lg" placeholder="0 zÅ‚ lub pozostaw puste"/>
              </div>
              <div>
                <label className="block text-gray-700 mb-1">PotencjaÅ‚ dochodowy drugiego rodzica (miesiÄ™cznie)</label>
                 <p className="text-xs text-gray-500 mb-2">Oszacowanie moÅ¼liwoÅ›ci zarobkowych.</p>
                <input type="number" className="w-full p-3 border-2 border-gray-200 rounded-lg" placeholder="0 zÅ‚ lub pozostaw puste"/>
              </div>
            </div>

            <h4 className="text-md font-semibold mt-6 mb-2 text-gray-800">Koszty Å¼ycia i zobowiÄ…zania drugiego rodzica</h4>
            <div className="space-y-4">
              <div>
                <label className="block text-gray-700 mb-1">Koszty utrzymania siebie drugiego rodzica (miesiÄ™cznie)</label>
                <input type="number" className="w-full p-3 border-2 border-gray-200 rounded-lg" placeholder="0 zÅ‚ lub pozostaw puste"/>
              </div>
              <div>
                <label className="block text-gray-700 mb-1">Koszty utrzymania innych osÃ³b przez drugiego rodzica (miesiÄ™cznie)</label>
                <input type="number" className="w-full p-3 border-2 border-gray-200 rounded-lg" placeholder="0 zÅ‚ lub pozostaw puste"/>
              </div>
              <div>
                <label className="block text-gray-700 mb-1">Dodatkowe zobowiÄ…zania drugiego rodzica (miesiÄ™cznie)</label>
                <input type="number" className="w-full p-3 border-2 border-gray-200 rounded-lg" placeholder="0 zÅ‚ lub pozostaw puste"/>
              </div>
            </div>
          </div>

          <div className="mt-6 flex gap-3">
            <button
              onclick="prevStep()"
              className="flex-1 bg-gray-200 text-gray-700 py-3 px-4 rounded-lg font-semibold hover:bg-gray-300 transition"
            >
              Wstecz
            </button>
            <button
              onclick="goToStep9FromStep8()"
              className="flex-1 bg-blue-600 text-white py-3 px-4 rounded-lg font-semibold hover:bg-blue-700 transition"
              id="step-8-next-button"
            >
              Dalej
            </button>
          </div>
        </div>
      </div>

      <!-- Step 9: Container step -->
      <div id="step-9" className="step">
        <!-- This is just a container step, the actual content will be in the variant divs -->
        <div style="display: none">Step 9 container</div>
      </div>

      <!-- Step 9 Court Variant: For court proceedings -->
      <div id="step-9-court" className="step" style="display: none;">
        <div className="bg-white rounded-lg shadow-sm p-6">
          <h2 className="text-xl font-bold mb-4">ğŸ§¾ Informacje o postÄ™powaniu sÄ…dowym</h2>
          <p className="text-gray-700 mb-6">
            W tej czÄ™Å›ci zbieramy informacje o decyzji, ktÃ³ra okreÅ›liÅ‚a zasady finansowania potrzeb dziecka â€“ moÅ¼e to byÄ‡ wyrok, 
            postanowienie zabezpieczajÄ…ce, ugoda lub inne rozstrzygniÄ™cie.
          </p>
          <p className="text-gray-700 mb-6">
            Chcemy lepiej zrozumieÄ‡ kontekst tej decyzji â€“ kiedy zapadÅ‚a, przez jaki sÄ…d zostaÅ‚a wydana, w jakim skÅ‚adzie, 
            oraz jak oceniasz jej adekwatnoÅ›Ä‡ wzglÄ™dem rzeczywistoÅ›ci. DziÄ™ki temu moÅ¼liwe bÄ™dzie trafniejsze porÃ³wnanie 
            Twojej sytuacji z innymi oraz lepsze uchwycenie rÃ³Å¼nic miÄ™dzy praktykÄ… rÃ³Å¼nych sÄ…dÃ³w.
          </p>
          <div className="space-y-4">
            <div>
              <label className="block text-gray-700 mb-2">Data decyzji lub zatwierdzenia porozumienia
                <span className="tooltip">
                  <span className="info-icon">i</span>
                  <span className="tooltiptext">DziÄ™ki tej dacie system lepiej dopasuje porÃ³wnania do sytuacji rynkowej i orzeczniczej z tamtego okresu.</span>
                </span>
              </label>
              <input type="date" className="w-full p-3 border-2 border-gray-200 rounded-lg" required>
            </div>
            <div>
              <label className="block text-gray-700 mb-2">SÄ…d, ktÃ³ry wydaÅ‚ decyzjÄ™</label>
              <div className="space-y-3">
                <select className="w-full p-3 border-2 border-gray-200 rounded-lg">
                  <option value="">Rodzaj sÄ…du</option>
                  <option value="rejonowy">SÄ…d Rejonowy</option>
                  <option value="okregowy">SÄ…d OkrÄ™gowy</option>
                </select>
                <select className="w-full p-3 border-2 border-gray-200 rounded-lg">
                  <option value="">WojewÃ³dztwo</option>
                  <option value="dolnoslaskie">DolnoÅ›lÄ…skie</option>
                  <option value="kujawsko-pomorskie">Kujawsko-Pomorskie</option>
                  <option value="lubelskie">Lubelskie</option>
                  <option value="lubuskie">Lubuskie</option>
                  <option value="lodzkie">ÅÃ³dzkie</option>
                  <option value="malopolskie">MaÅ‚opolskie</option>
                  <option value="mazowieckie">Mazowieckie</option>
                  <option value="opolskie">Opolskie</option>
                  <option value="podkarpackie">Podkarpackie</option>
                  <option value="podlaskie">Podlaskie</option>
                  <option value="pomorskie">Pomorskie</option>
                  <option value="slaskie">ÅšlÄ…skie</option>
                  <option value="swietokrzyskie">ÅšwiÄ™tokrzyskie</option>
                  <option value="warminsko-mazurskie">WarmiÅ„sko-Mazurskie</option>
                  <option value="wielkopolskie">Wielkopolskie</option>
                  <option value="zachodniopomorskie">Zachodniopomorskie</option>
                </select>
                <input type="text" className="w-full p-3 border-2 border-gray-200 rounded-lg" placeholder="MiejscowoÅ›Ä‡ sÄ…du">
              </div>
              <p className="text-sm text-gray-500 mt-1">Pozwoli to na mapowanie lokalnych rÃ³Å¼nic w orzecznictwie.</p>
            </div>
            <div>
              <label className="block text-gray-700 mb-2">SkÅ‚ad orzekajÄ…cy</label>
              <div className="space-y-3">
                <select className="w-full p-3 border-2 border-gray-200 rounded-lg">
                  <option value="">Liczba sÄ™dziÃ³w</option>
                  <option value="jeden">1 sÄ™dzia</option>
                  <option value="trzech">3 sÄ™dziÃ³w</option>
                </select>
                <select className="w-full p-3 border-2 border-gray-200 rounded-lg">
                  <option value="">PÅ‚eÄ‡ sÄ™dziego przewodniczÄ…cego</option>
                  <option value="kobieta">Kobieta</option>
                  <option value="mezczyzna">MÄ™Å¼czyzna</option>
                </select>
                <input type="text" className="w-full p-3 border-2 border-gray-200 rounded-lg" placeholder="InicjaÅ‚y sÄ™dziego prowadzÄ…cego (opcjonalnie)">
              </div>
            </div>
            <div>
              <label className="block text-gray-700 mb-2">Czy to Ty zÅ‚oÅ¼yÅ‚eÅ›/Å‚aÅ› pozew?</label>
              <div className="space-y-2">
                <label className="flex items-center">
                  <input type="radio" name="pozew-skladajacy" value="tak" className="mr-2">
                  Tak
                </label>
                <label className="flex items-center">
                  <input type="radio" name="pozew-skladajacy" value="nie" className="mr-2">
                  Nie
                </label>
              </div>
            </div>
            <div>
              <label className="block text-gray-700 mb-2">Czy w pozwie pojawiÅ‚ siÄ™ wÄ…tek winy?</label>
              <div className="space-y-2">
                <label className="flex items-center">
                  <input type="radio" name="wina-pozew" value="tak-ja" className="mr-2">
                  Tak â€“ domagaÅ‚em/am siÄ™ orzeczenia o winie
                </label>
                <label className="flex items-center">
                  <input type="radio" name="wina-pozew" value="tak-druga-strona" className="mr-2">
                  Tak â€“ druga strona domagaÅ‚a siÄ™ orzeczenia o winie
                </label>
                <label className="flex items-center">
                  <input type="radio" name="wina-pozew" value="nie" className="mr-2">
                  Nie
                </label>
              </div>
            </div>
           <div className="mt-3">
    <div className="text-sm text-gray-600 mb-2">OceÅ„ w skali 1â€“5, gdzie 1 oznacza â€zupeÅ‚nie nieadekwatny", a 5 â€w peÅ‚ni adekwatny"</div>
    
    <div className="relative py-5">
      <div className="flex justify-between mb-1">
        <span className="text-sm text-gray-600">zupeÅ‚nie nieadekwatny</span>
        <span className="text-sm text-gray-600">w peÅ‚ni adekwatny</span>
      </div>
      
      <div className="flex justify-between mb-2">
        <span>1</span>
        <span>2</span>
        <span>3</span>
        <span>4</span>
        <span>5</span>
      </div>
      
      <input 
        type="range" 
        min="1" 
        max="5" 
        step="1" 
        value="3"
        name="finansowanie-ocena"
        className="w-full h-3 bg-gray-200 rounded-lg appearance-none cursor-pointer"
        oninput="document.getElementById('rating-value').textContent = this.value"
      >
      
      <div className="flex justify-center mt-4">
        <span className="inline-block px-4 py-2 bg-blue-600 text-white font-semibold text-lg rounded-full">
          Ocena: <span id="rating-value">3</span>
        </span>  
      </div>
    </div>
  </div>
          </div>
          <div className="mt-6 flex gap-3">
            <button
              onclick="prevStep()"
              className="flex-1 bg-gray-200 text-gray-700 py-3 px-4 rounded-lg font-semibold hover:bg-gray-300 transition"
            >
              Wstecz
            </button>
            <button
              onclick="nextStep()"
              className="flex-1 bg-blue-600 text-white py-3 px-4 rounded-lg font-semibold hover:bg-blue-700 transition"
            >
              Dalej
            </button>
          </div>
        </div>
      </div>

      <!-- Step 9 Agreement Variant: For mediation or private agreements -->
      <div id="step-9-agreement" className="step" style="display: none;">
        <div className="bg-white rounded-lg shadow-sm p-6">
          <h2 className="text-xl font-bold mb-4">ğŸ§¾ Informacje o porozumieniu</h2>
          <p className="text-gray-700 mb-6">
            W tej czÄ™Å›ci zbieramy informacje o porozumieniu, ktÃ³re okreÅ›liÅ‚o zasady finansowania potrzeb dziecka. 
            ZaleÅ¼y nam na lepszym zrozumieniu kontekstu zawartego porozumienia - kiedy zostaÅ‚o zawarte, w jaki sposÃ³b, 
            oraz jakÄ… ma formÄ™.
          </p>
          <p className="text-gray-700 mb-6">
          Wiemy, Å¼e wiele porozumieÅ„ nie trafia do sÄ…du, ale majÄ… one realne znaczenie w codziennym Å¼yciu i w rzeczywistoÅ›ci alimentacyjnej. Chcemy zrozumieÄ‡, kiedy powstaÅ‚o takie porozumienie, jakie byÅ‚y jego podstawy, kto je zainicjowaÅ‚ i jak oceniasz jego adekwatnoÅ›Ä‡. DziÄ™ki temu moÅ¼liwe bÄ™dzie peÅ‚niejsze uchwycenie rÃ³Å¼norodnoÅ›ci praktyki â€“ nie tylko tej sÄ…dowej.
          <div className="space-y-4">
            <div>
              <label className="block text-gray-700 mb-2">Data zawarcia porozumienia
                <span className="tooltip">
                  <span className="info-icon">i</span>
                  <span className="tooltiptext">DziÄ™ki tej dacie system lepiej dopasuje porÃ³wnania do sytuacji rynkowej z tamtego okresu.</span>
                </span>
              </label>
              <input type="date" className="w-full p-3 border-2 border-gray-200 rounded-lg" required>
            </div>
            <div>
              <label className="block text-gray-700 mb-2">SposÃ³b zawarcia porozumienia</label>
              <select className="w-full p-3 border-2 border-gray-200 rounded-lg">
                <option value="">Wybierz...</option>
                <option value="mediator">Przy udziale mediatora</option>
                <option value="prawnik">Przy udziale prawnika/adwokata</option>
                <option value="samodzielnie">Samodzielnie (bezpoÅ›rednio miÄ™dzy rodzicami)</option>
                <option value="inny">Inny</option>
              </select>
            </div>
            <div>
              <label className="block text-gray-700 mb-2">Forma porozumienia</label>
              <select className="w-full p-3 border-2 border-gray-200 rounded-lg">
                <option value="">Wybierz...</option>
                <option value="pisemna">Pisemna (podpisany dokument)</option>
                <option value="ustna">Ustna (bez dokumentu)</option>
                <option value="elektroniczna">Elektroniczna (e-mail, wiadomoÅ›ci)</option>
                <option value="inna">Inna</option>
              </select>
            </div>
            <div>
              <label className="block text-gray-700 mb-2">Czy porozumienie zawiera klauzulÄ™ waloryzacyjnÄ…?
                <span className="tooltip">
                  <span className="info-icon">i</span>
                  <span className="tooltiptext">Klauzula waloryzacyjna to sposÃ³b na automatyczne dostosowanie wysokoÅ›ci alimentÃ³w do zmieniajÄ…cych siÄ™ warunkÃ³w ekonomicznych, np. poprzez corocznÄ… indeksacjÄ™ o wskaÅºnik inflacji.</span>
                </span>
              </label>
              <div className="space-y-2">
                <label className="flex items-center">
                  <input type="radio" name="klauzula-waloryzacyjna" value="tak" className="mr-2">
                  Tak
                </label>
                <label className="flex items-center">
                  <input type="radio" name="klauzula-waloryzacyjna" value="nie" className="mr-2">
                  Nie
                </label>
                <label className="flex items-center">
                  <input type="radio" name="klauzula-waloryzacyjna" value="nie-wiem" className="mr-2">
                  Nie wiem
                </label>
              </div>
            </div>
    <div className="mt-3">
    <div className="text-sm text-gray-600 mb-2">OceÅ„ w skali 1â€“5, gdzie 1 oznacza â€zupeÅ‚nie nieadekwatny", a 5 â€w peÅ‚ni adekwatny"</div>
    
    <div className="relative py-5">
      <div className="flex justify-between mb-1">
        <span className="text-sm text-gray-600">zupeÅ‚nie nieadekwatny</span>
        <span className="text-sm text-gray-600">w peÅ‚ni adekwatny</span>
      </div>
      
      <div className="flex justify-between mb-2">
        <span>1</span>
        <span>2</span>
        <span>3</span>
        <span>4</span>
        <span>5</span>
      </div>
      
      <input 
        type="range" 
        min="1" 
        max="5" 
        step="1" 
        value="3"
        name="finansowanie-ocena"
        className="w-full h-3 bg-gray-200 rounded-lg appearance-none cursor-pointer"
        oninput="document.getElementById('rating-value').textContent = this.value"
      >
      
      <div className="flex justify-center mt-4">
        <span className="inline-block px-4 py-2 bg-blue-600 text-white font-semibold text-lg rounded-full">
          Ocena: <span id="rating-value">3</span>
        </span>  
      </div>
    </div>
  </div>
  </div>
          </div>
          <div className="mt-6 flex gap-3">
            <button
              onclick="prevStep()"
              className="flex-1 bg-gray-200 text-gray-700 py-3 px-4 rounded-lg font-semibold hover:bg-gray-300 transition"
            >
              Wstecz
            </button>
            <button
              onclick="nextStep()"
              className="flex-1 bg-blue-600 text-white py-3 px-4 rounded-lg font-semibold hover:bg-blue-700 transition"
            >
              Dalej
            </button>
          </div>
        </div>
      </div>

     <!-- Step 9 Other Variant: For other arrangements -->
<div id="step-9-other" className="step" style="display: none">
  <div className="bg-white rounded-lg shadow-sm p-6">
    <h2 className="text-xl font-bold mb-4">
      ğŸ§¾ Ustalenia tymczasowe, ustne lub jednostronne
    </h2>
    <p className="text-gray-700 mb-6">
      Czasem sposÃ³b dzielenia siÄ™ kosztami dziecka nie wynika z decyzji sÄ…du ani formalnego porozumienia â€“ ale z doraÅºnych, tymczasowych lub jednostronnych ustaleÅ„. Chcemy lepiej zrozumieÄ‡ takÅ¼e te sytuacje. To waÅ¼ne, by uchwyciÄ‡, jak w praktyce wyglÄ…dajÄ… rozwiÄ…zania stosowane przez rodzicÃ³w poza oficjalnymi Å›cieÅ¼kami.
    </p>
    <div className="space-y-4">
      <div>
        <label className="block text-gray-700 mb-2">
          Od kiedy obowiÄ…zuje obecny sposÃ³b finansowania potrzeb dziecka?
          <span className="tooltip">
            <span className="info-icon">i</span>
            <span className="tooltiptext">DziÄ™ki tej dacie system lepiej dopasuje porÃ³wnania do sytuacji rynkowej i orzeczniczej z tamtego okresu.</span>
          </span>
        </label>
        <input
          type="date"
          className="w-full p-3 border-2 border-gray-200 rounded-lg"
        />
      </div>
      <div>
        <label className="block text-gray-700 mb-2">
          Czy sposÃ³b finansowania zostaÅ‚ wczeÅ›niej uzgodniony z drugim rodzicem?
          <span className="tooltip">
            <span className="info-icon">i</span>
            <span className="tooltiptext">To pytanie pomaga zrozumieÄ‡, czy podziaÅ‚ kosztÃ³w oparty jest na konsensusie czy presji jednej ze stron.</span>
          </span>
        </label>
        <select className="w-full p-3 border-2 border-gray-200 rounded-lg">
          <option value="">Wybierz...</option>
          <option value="wspolnie">Tak, wspÃ³lnie ustaliliÅ›my zasady</option>
          <option value="jednostronnie-ja">Nie â€“ to moje jednostronne decyzje</option>
          <option value="jednostronnie-drugi">Nie â€“ to drugi rodzic narzuciÅ‚ te zasady</option>
        </select>
      </div>
      <div>
        <label className="block text-gray-700 mb-2">
          Czy ktÃ³rykolwiek z rodzicÃ³w planuje w najbliÅ¼szym czasie wystÄ…pienie do sÄ…du w sprawie alimentÃ³w?
        </label>
        <select className="w-full p-3 border-2 border-gray-200 rounded-lg">
          <option value="">Wybierz...</option>
          <option value="ja-planuje">Tak, ja planujÄ™</option>
          <option value="drugi-planuje">Tak, drugi rodzic zapowiedziaÅ‚ taki krok</option>
          <option value="nie-wiem">Nie wiem</option>
          <option value="nie-planujemy">Nie planujemy</option>
        </select>
      </div>
      <div>
  <label className="block text-gray-700 mb-2">
    Jak oceniasz aktualny sposÃ³b finansowania potrzeb dziecka?
    <span className="tooltip">
      <span className="info-icon">i</span>
      <span className="tooltiptext">Ta odpowiedÅº nie wpÅ‚ywa na TwÃ³j raport â€“ ale pomoÅ¼e nam lepiej rozpoznaÄ‡, kiedy brak formalnych ustaleÅ„ prowadzi do niesprawiedliwych rozwiÄ…zaÅ„.</span>
    </span>
  </label>
  <div className="mt-3">
    <div className="text-sm text-gray-600 mb-2">OceÅ„ w skali 1â€“5, gdzie 1 oznacza â€zupeÅ‚nie nieadekwatny", a 5 â€w peÅ‚ni adekwatny"</div>
    
    <div className="relative py-5">
      <div className="flex justify-between mb-1">
        <span className="text-sm text-gray-600">zupeÅ‚nie nieadekwatny</span>
        <span className="text-sm text-gray-600">w peÅ‚ni adekwatny</span>
      </div>
      
      <div className="flex justify-between mb-2">
        <span>1</span>
        <span>2</span>
        <span>3</span>
        <span>4</span>
        <span>5</span>
      </div>
      
      <input 
        type="range" 
        min="1" 
        max="5" 
        step="1" 
        value="3"
        name="finansowanie-ocena"
        className="w-full h-3 bg-gray-200 rounded-lg appearance-none cursor-pointer"
        oninput="document.getElementById('rating-value').textContent = this.value"
      >
      
      <div className="flex justify-center mt-4">
        <span className="inline-block px-4 py-2 bg-blue-600 text-white font-semibold text-lg rounded-full">
          Ocena: <span id="rating-value">3</span>
        </span>  
      </div>
    </div>
  </div>
</div>
    <div className="mt-6 flex gap-3">
      <button
        onclick="prevStep()"
        className="flex-1 bg-gray-200 text-gray-700 py-3 px-4 rounded-lg font-semibold hover:bg-gray-300 transition"
      >
        Wstecz
      </button>
      <button
        onclick="nextStep()"
        className="flex-1 bg-blue-600 text-white py-3 px-4 rounded-lg font-semibold hover:bg-blue-700 transition"
      >
        Dalej
      </button>
    </div>
  </div>
</div>
</div>
      <!-- Step 10: Demographics -->
      <div id="step-10" className="step">
        <div className="bg-white rounded-lg shadow-sm p-6">
          <h2 className="text-xl font-bold mb-4">
            Informacje o Tobie i drugim rodzicu
          </h2>
          <p className="text-gray-700 mb-4">Ta czÄ™Å›Ä‡ formularza pozwoli nam lepiej dopasowaÄ‡ analizÄ™ do Twojej sytuacji i zwiÄ™kszyÄ‡ wiarygodnoÅ›Ä‡ raportÃ³w. Zbieramy wyÅ‚Ä…cznie podstawowe dane demograficzne â€“ nie pytamy o nazwiska, adresy ani inne dane umoÅ¼liwiajÄ…ce identyfikacjÄ™.</p>
          <p className="text-gray-700 mb-6">DziÄ™ki temu moÅ¼liwa bÄ™dzie analiza wpÅ‚ywu kontekstu spoÅ‚ecznego i geograficznego na kwestie alimentacyjne.</p>
          
          <div className="space-y-6">
            <div>
              <h3 className="text-lg font-semibold mb-3">O Tobie</h3>
              <div className="space-y-4">
                <div>
                  <label className="block text-gray-700 mb-2">PÅ‚eÄ‡</label>
                  <select className="w-full p-3 border-2 border-gray-200 rounded-lg" name="user_gender">
                    <option value="">Wybierz...</option>
                    <option value="kobieta">Kobieta</option>
                    <option value="mezczyzna">MÄ™Å¼czyzna</option>
                  </select>
                </div>
                <div>
                  <label className="block text-gray-700 mb-2">Wiek</label>
                  <select className="w-full p-3 border-2 border-gray-200 rounded-lg" name="user_age">
                    <option value="">Wybierz...</option>
                    <option value="ponizej_25">PoniÅ¼ej 25 lat</option>
                    <option value="25_34">25-34 lata</option>
                    <option value="35_44">35-44 lata</option>
                    <option value="45_54">45-54 lata</option>
                    <option value="powyzej_55">55 lat i wiÄ™cej</option>
                  </select>
                </div>
                <div>
                  <label className="block text-gray-700 mb-2">WojewÃ³dztwo zamieszkania</label>
                  <select className="w-full p-3 border-2 border-gray-200 rounded-lg" name="user_voivodeship">
                    <option value="">Wybierz...</option>
                    {/* Populate with all 16 voivodeships */}
                    <option>DolnoÅ›lÄ…skie</option><option>Kujawsko-pomorskie</option><option>Lubelskie</option><option>Lubuskie</option><option>ÅÃ³dzkie</option><option>MaÅ‚opolskie</option><option>Mazowieckie</option><option>Opolskie</option><option>Podkarpackie</option><option>Podlaskie</option><option>Pomorskie</option><option>ÅšlÄ…skie</option><option>ÅšwiÄ™tokrzyskie</option><option>WarmiÅ„sko-mazurskie</option><option>Wielkopolskie</option><option>Zachodniopomorskie</option>
                  </select>
                </div>
                <div>
                  <label className="block text-gray-700 mb-2">Rodzaj miejscowoÅ›ci zamieszkania</label>
                  <select className="w-full p-3 border-2 border-gray-200 rounded-lg" name="user_locality_type">
                    <option value="">Wybierz...</option>
                    <option value="wies">WieÅ›</option>
                    <option value="miasto_do_50">Miasto do 50 tys. mieszkaÅ„cÃ³w</option>
                    <option value="miasto_50_200">Miasto 50-200 tys. mieszkaÅ„cÃ³w</option>
                    <option value="miasto_powyzej_200">Miasto powyÅ¼ej 200 tys. mieszkaÅ„cÃ³w</option>
                  </select>
                </div>
                <div>
                  <label className="block text-gray-700 mb-2">Stan cywilny
                     <span className="tooltip"><span className="info-icon">i</span><span className="tooltiptext-wide">Te informacje pomagajÄ… lepiej osadziÄ‡ dane w realiach prawnych â€“ np. czy uÅ¼ytkownik juÅ¼ przeszedÅ‚ przez proces rozwodowy, czy dopiero przed nim stoi. To waÅ¼ne w analizach, ktÃ³re majÄ… daÄ‡ moÅ¼liwie najbardziej precyzyjny kontekst sytuacji.</span></span>
                  </label>
                  <select className="w-full p-3 border-2 border-gray-200 rounded-lg" name="user_marital_status">
                    <option value="">Wybierz...</option>
                    <option value="malzenstwo">MaÅ‚Å¼eÅ„stwo</option>
                    <option value="separacja">W separacji</option>
                    <option value="rozwod_w_trakcie">W trakcie postÄ™powania rozwodowego</option>
                    <option value="rozwod_bez_winy">RozwÃ³d bez orzeczenia o winie</option>
                    <option value="rozwod_z_wina">RozwÃ³d z orzeczeniem o winie</option>
                    <option value="inne">Inne</option>
                  </select>
                </div>
              </div>
            </div>

            <div>
              <h3 className="text-lg font-semibold mb-3">O drugim rodzicu</h3>
              <div className="space-y-4">
                 <div>
                  <label className="block text-gray-700 mb-2">PÅ‚eÄ‡</label>
                  <select className="w-full p-3 border-2 border-gray-200 rounded-lg" name="other_parent_gender">
                    <option value="">Wybierz...</option>
                    <option value="kobieta">Kobieta</option>
                    <option value="mezczyzna">MÄ™Å¼czyzna</option>
                    <option value="nie_dotyczy">Nie wiem / Nie chcÄ™ podawaÄ‡</option>
                  </select>
                </div>
                <div>
                  <label className="block text-gray-700 mb-2">Wiek</label>
                  <select className="w-full p-3 border-2 border-gray-200 rounded-lg" name="other_parent_age">
                    <option value="">Wybierz...</option>
                    <option value="ponizej_25">PoniÅ¼ej 25 lat</option>
                    <option value="25_34">25-34 lata</option>
                    <option value="35_44">35-44 lata</option>
                    <option value="45_54">45-54 lata</option>
                    <option value="powyzej_55">55 lat i wiÄ™cej</option>
                    <option value="nie_dotyczy">Nie wiem / Nie chcÄ™ podawaÄ‡</option>
                  </select>
                </div>
                <div>
                  <label className="block text-gray-700 mb-2">WojewÃ³dztwo zamieszkania</label>
                  <select className="w-full p-3 border-2 border-gray-200 rounded-lg" name="other_parent_voivodeship">
                     <option value="">Wybierz...</option>
                    {/* Populate with all 16 voivodeships */}
                    <option>DolnoÅ›lÄ…skie</option><option>Kujawsko-pomorskie</option><option>Lubelskie</option><option>Lubuskie</option><option>ÅÃ³dzkie</option><option>MaÅ‚opolskie</option><option>Mazowieckie</option><option>Opolskie</option><option>Podkarpackie</option><option>Podlaskie</option><option>Pomorskie</option><option>ÅšlÄ…skie</option><option>ÅšwiÄ™tokrzyskie</option><option>WarmiÅ„sko-mazurskie</option><option>Wielkopolskie</option><option>Zachodniopomorskie</option>
                    <option value="nie_dotyczy">Nie wiem / Nie chcÄ™ podawaÄ‡</option>
                  </select>
                </div>
                <div>
                  <label className="block text-gray-700 mb-2">Rodzaj miejscowoÅ›ci zamieszkania</label>
                  <select className="w-full p-3 border-2 border-gray-200 rounded-lg" name="other_parent_locality_type">
                    <option value="">Wybierz...</option>
                    <option value="wies">WieÅ›</option>
                    <option value="miasto_do_50">Miasto do 50 tys. mieszkaÅ„cÃ³w</option>
                    <option value="miasto_50_200">Miasto 50-200 tys. mieszkaÅ„cÃ³w</option>
                    <option value="miasto_powyzej_200">Miasto powyÅ¼ej 200 tys. mieszkaÅ„cÃ³w</option>
                    <option value="nie_dotyczy">Nie wiem / Nie chcÄ™ podawaÄ‡</option>
                  </select>
                </div>
              </div>
            </div>
          </div>
          <div className="mt-6 flex gap-3">
            <button
              onclick="prevStep()"
              className="flex-1 bg-gray-200 text-gray-700 py-3 px-4 rounded-lg font-semibold hover:bg-gray-300 transition"
            >
              Wstecz
            </button>
            <button
              onclick="nextStep()"
              className="flex-1 bg-blue-600 text-white py-3 px-4 rounded-lg font-semibold hover:bg-blue-700 transition"
            >
              Dalej
            </button>
          </div>
        </div>
      </div>

      <!-- Step 11: Email and consent -->
      <div id="step-11" className="step">
        <div className="bg-white rounded-lg shadow-sm p-6">
          <h2 className="text-xl font-bold mb-4">Podanie e-maila i zgody</h2>
          <p className="text-gray-700 mb-2">
            Zostaw swÃ³j adres e-mail, Å¼ebyÅ›my mogli przesÅ‚aÄ‡ Ci spersonalizowany
            raport przygotowany na podstawie Twoich odpowiedzi.
          </p>
          <p className="text-sm text-gray-600 mb-6">
            Potrzebujemy Twojego adresu e-mail â€“ wyÅ‚Ä…cznie po to, Å¼ebyÅ›my mogli bezpiecznie przesÅ‚aÄ‡ Ci TwÃ³j raport. TwÃ³j adres przechowujemy zgodnie z RODO. Nie wykorzystujemy go do Å¼adnych innych celÃ³w. Dane analityczne i kontaktowe sÄ… przechowywane oddzielnie, choÄ‡ na potrzeby przygotowania raportu moÅ¼liwe jest ich powiÄ…zanie. W kaÅ¼dej chwili moÅ¼esz zaÅ¼Ä…daÄ‡ wglÄ…du, zmiany lub usuniÄ™cia wszystkich swoich danych.
          </p>
          <div className="space-y-4">
            <div>
              <label className="block text-gray-700 mb-2">TwÃ³j adres e-mail (wymagane)
                <span className="tooltip">
                  <span className="info-icon">i</span>
                  <span className="tooltiptext-wide">TwÃ³j e-mail bÄ™dzie wykorzystany wyÅ‚Ä…cznie w celu przesÅ‚ania Ci spersonalizowanego raportu. Nie bÄ™dziemy wysyÅ‚aÄ‡ Å¼adnych reklam ani udostÄ™pniaÄ‡ Twoich danych osobom trzecim. Adres e-mail bÄ™dzie przechowywany oddzielnie od danych analitycznych.</span>
                </span>
              </label>
              <input
                type="email"
                id="final-email"
                className="w-full p-3 border-2 border-gray-200 rounded-lg"
                placeholder="twoj@email.pl"
                required
              />
            </div>
            <div className="space-y-3 mt-6">
              <h3 className="text-lg font-semibold text-gray-800">Zgody i ochrona prywatnoÅ›ci</h3>
              <p className="text-sm text-gray-600">Zanim zakoÅ„czysz wypeÅ‚nianie formularza, prosimy CiÄ™ o wyraÅ¼enie zgÃ³d niezbÄ™dnych do przygotowania i przesÅ‚ania raportu.</p>
              <label className="flex items-start">
                <input type="checkbox" id="consent-data-processing" className="mt-1 mr-3" required />
                <span className="text-sm"
                  >âœ… WyraÅ¼am zgodÄ™ na przetwarzanie przekazanych przeze mnie
                  danych w celu ich analizy statystycznej i wygenerowania
                  spersonalizowanego raportu w ramach projektu AliMatrix.</span
                >
              </label>
              <label className="flex items-start">
                <input type="checkbox" id="consent-contact" className="mt-1 mr-3" required />
                <span className="text-sm"
                  >âœ… WyraÅ¼am zgodÄ™ na kontakt mailowy w celu dostarczenia mojego
                  raportu oraz ewentualnej komunikacji zwiÄ…zanej z dalszÄ…
                  realizacjÄ… usÅ‚ugi. MÃ³j adres e-mail bÄ™dzie przechowywany oddzielnie od pozostaÅ‚ych danych analitycznych.</span
                >
              </label>
            </div>
            <div className="bg-gray-100 p-4 rounded-lg mt-4">
              <p className="text-sm text-gray-700 font-semibold">ğŸ”’ Klauzula informacyjna RODO (skrÃ³towa wersja)</p>
              <p className="text-xs text-gray-600">
                AliMatrix przetwarza Twoje dane zgodnie z RODO â€“ z peÅ‚nym
                poszanowaniem prywatnoÅ›ci. Dane kontaktowe i analityczne sÄ… od
                siebie oddzielone. W kaÅ¼dej chwili moÅ¼esz zaÅ¼Ä…daÄ‡ wglÄ…du, korekty lub usuniÄ™cia wszystkich danych, ktÃ³re przekazaÅ‚eÅ›. SzczegÃ³Å‚y znajdziesz w Polityce PrywatnoÅ›ci i Regulaminie. (Linki do dodania)
              </p>
            </div>
          </div>
          <div className="mt-6 flex gap-3">
            <button
              onclick="prevStep()"
              className="flex-1 bg-gray-200 text-gray-700 py-3 px-4 rounded-lg font-semibold hover:bg-gray-300 transition"
            >
              Wstecz
            </button>
            <button
              onclick="finishForm()"
              className="flex-1 bg-blue-600 text-white py-3 px-4 rounded-lg font-semibold hover:bg-blue-700 transition"
            >
              ZakoÅ„cz
            </button>
          </div>
        </div>
      </div>

      <!-- Step 12: Thank you -->
      <div id="step-12" className="step">
        <div className="bg-white rounded-lg shadow-sm p-6 text-center">
          <div className="mb-4">
            <div
              className="inline-flex items-center justify-center w-16 h-16 bg-green-100 rounded-full mb-4"
            >
              <svg
                className="w-8 h-8 text-green-600"
                fill="none"
                stroke="currentColor"
                viewBox="0 0 24 24"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M5 13l4 4L19 7"
                ></path>
              </svg>
            </div>
          </div>
          <h2 className="text-2xl font-bold mb-4">
            DziÄ™kujemy za wypeÅ‚nienie formularza AliMatrix!
          </h2>
          
          <div className="bg-blue-50 p-4 rounded-lg mb-6">
            <p className="font-semibold mb-2">ID Twojego zgÅ‚oszenia:</p>
            <div className="flex items-center justify-center space-x-2">
              <span id="submission-id" className="font-mono text-lg"></span>
              <button onclick="copySubmissionId()" className="bg-blue-600 text-white px-3 py-1 rounded hover:bg-blue-700">
                Kopiuj
              </button>
            </div>
          </div>

          <div className="space-y-4 text-gray-700 mb-6">
            <p>
              Twoje odpowiedzi majÄ… znaczenie â€“ nie tylko dla Ciebie, ale rÃ³wnieÅ¼ dla setek innych osÃ³b w podobnej sytuacji. DziÄ™ki Tobie system AliMatrix staje siÄ™ bardziej precyzyjny, a raporty â€“ bardziej wiarygodne.
            </p>
             <p>
              To waÅ¼ny krok w kierunku wiÄ™kszej przejrzystoÅ›ci i sprawiedliwoÅ›ci w sprawach dotyczÄ…cych finansowania potrzeb dzieci.
            </p>
            <p>
              TwÃ³j indywidualny raport zostanie przygotowany na podstawie
              dostarczonych danych. JeÅ›li jesteÅ› wÅ›rÃ³d pierwszych 1000 osÃ³b, ktÃ³re wypeÅ‚niÅ‚y formularz -
              otrzymasz go bezpÅ‚atnie na podany adres e-mail.
            </p>
             <p>
              W miÄ™dzyczasie moÅ¼esz Å›ledziÄ‡ postÄ™py projektu i dowiedzieÄ‡ siÄ™ wiÄ™cej o tym, jak Twoje dane przyczyniajÄ… siÄ™ do budowy nowego standardu â€“ odwiedzajÄ…c naszÄ… stronÄ™ lub wspierajÄ…c projekt na Zrzutka.pl.
            </p>
          </div>
          <div className="flex gap-4 justify-center mt-6">
            <button onclick="resetForm()" className="bg-gray-600 text-white py-2 px-4 rounded-lg hover:bg-gray-700 transition">
              Zacznij od nowa
            </button>
            <button onclick="window.open('https://zrzutka.pl', '_blank')" className="bg-pink-500 text-white py-2 px-4 rounded-lg hover:bg-pink-600 transition">
              Wesprzyj projekt
            </button>
            </div>
        </div>
      </div>
    </main>

    <script>
      let currentStep = 1;
      const totalSteps = 12;
      let selectedPath = "";
      window.selectedLegalBasis = null; // Store legal basis for step 9
      let formData = {};

      // Map of step dependencies and conditions
   const stepFlow = {
  1: { next: 2 },
  2: { 
    next: (path) => path === "established" ? "3a" : "3b",
    prev: 1
  },
  "3a": { next: 4, prev: 2 },
  "3b": { next: 12, prev: 2 },
  4: { next: 5, prev: "3a" },
  5: { 
    next: 6,  // Zawsze idziemy do kroku 6 (czas opieki), niezaleÅ¼nie od typu opieki
    prev: 4
  },
  6: { 
    next: 7,  // Zawsze idziemy do kroku 7 (koszty) po kroku 6, niezaleÅ¼nie od typu opieki
    prev: 5 
  },
  7: { 
    next: 8,  // Z kroku 7 (koszty) zawsze idziemy do kroku 8 (dochody)
    prev: 6   // Wracamy do kroku 6 (czas opieki)
  },
  8: { 
    next: 9, 
    prev: 7   // Zawsze wracamy do kroku 7 (koszty), a nie bezpoÅ›rednio do 6
  },
  9: { next: 10, prev: 8 },
  10: { next: 11, prev: 9 },
  11: { next: 12, prev: 10 },
  12: { prev: 11 }
};

      function showStep(step) {
        try {
          // Hide all steps
          document.querySelectorAll('.step').forEach(s => {
            s.style.display = 'none';
            s.classList.remove('active');
          });
          
          // Special handling for step 9 - instead of showing the base step-9,
          // we'll directly show the relevant variant based on the selected legal basis
          if (step === 9) {
            console.log("Reached step 9, showing appropriate variant");
            
            // Make sure we still have the legal basis from step 4
            if (!window.selectedLegalBasis) {
              console.warn("Legal basis not found in window.selectedLegalBasis, trying to get it from the form");
              window.selectedLegalBasis = document.querySelector('input[name="legal-basis"]:checked')?.value || 'inne';
              console.log("Retrieved or defaulted legal basis:", window.selectedLegalBasis);
            }
            
            // Get base step-9 to mark as active for state tracking
            const baseStep9 = document.getElementById('step-9');
            if (baseStep9) {
              baseStep9.classList.add('active');
            }
            
            // Handle the step-9 variants based on legal basis
            handleStep9Variants();
            
            // Update progress bar and current step
            updateProgress(step);
            currentStep = step;
            
            // We've handled step 9 specially, so return early
            return;
          }
          
          // Show selected step for all other steps
          const selectedStep = document.getElementById(`step-${step}`);
          if (!selectedStep) {
            console.error(`Step ${step} not found`);
            return;
          }

          selectedStep.style.display = 'block';
          selectedStep.classList.add('active');

          // Update progress bar
          updateProgress(step);

          // Reinitialize tooltips for the current step
          initializeTooltips();

          // Save current step
          currentStep = step;
          console.log("Showing step:", step);
        } catch (error) {
          console.error('Error in showStep:', error);
        }
      }

      function handleStep9Variants() {
        try {
          // Get the legal basis from the stored value first, then try to get it from the form
          const legalBasis = window.selectedLegalBasis || document.querySelector('input[name="legal-basis"]:checked')?.value;
          console.log("Legal basis for step 9:", legalBasis);

          if (!legalBasis) {
            console.error("No legal basis found, cannot determine which variant to show");
            // Set a default to prevent errors
            window.selectedLegalBasis = 'inne';
          }
          
          // Hide all step 9 variants first
          ['step-9-court', 'step-9-agreement', 'step-9-other'].forEach(id => {
            const element = document.getElementById(id);
            if (element) {
              element.style.display = 'none';
              console.log(`Hiding ${id}`);
            } else {
              console.error(`Element ${id} not found`);
            }
          });

          // Show appropriate section based on legal basis
          let targetStep = null;
          if (['zabezpieczenie', 'wyrok', 'ugoda-sad'].includes(legalBasis)) {
            targetStep = 'step-9-court';
          } else if (['mediacja', 'prywatne'].includes(legalBasis)) {
            targetStep = 'step-9-agreement';
          } else {
            // Default to step-9-other if no legal basis was found or it's "inne"
            targetStep = 'step-9-other';
          }
          
          // Add explicit debug output
          console.log(`Selected legal basis: ${legalBasis}, Target step: ${targetStep}`);

          if (targetStep) {
            const element = document.getElementById(targetStep);
            if (element) {
              element.style.display = 'block';
              console.log(`Showing ${targetStep}`);
              
              // Extra verification to ensure other variants remain hidden
              ['step-9-court', 'step-9-agreement', 'step-9-other'].forEach(id => {
                if (id !== targetStep) {
                  const otherElement = document.getElementById(id);
                  if (otherElement && otherElement.style.display !== 'none') {
                    console.warn(`WARNING: ${id} should be hidden but is visible. Hiding it.`);
                    otherElement.style.display = 'none';
                  }
                }
              });
            } else {
              console.error(`Element ${targetStep} not found`);
            }
          } else {
            console.warn(`No target step determined for legal basis: ${legalBasis}`);
          }
        } catch (error) {
          console.error("Error in handleStep9Variants:", error);
        }
      }

      // Special function to handle transition from step 8 to step 9
      function goToStep9FromStep8() {
        try {
          console.log("Special transition from step 8 to step 9");
          
          // First check if the current step validation passes
          if (!validateStep(8)) {
            alert('ProszÄ™ wypeÅ‚niÄ‡ wszystkie wymagane pola przed przejÅ›ciem dalej.');
            return;
          }
          
          // Make sure to save the form data from step 8
          saveFormData();
          
          // Ensure we have a valid legal basis from step 4
          if (!window.selectedLegalBasis) {
            console.warn("No legal basis found for step 9, checking form or defaulting to 'inne'");
            // Try to get it from the form again
            window.selectedLegalBasis = document.querySelector('input[name="legal-basis"]:checked')?.value || 'inne';
          }
          
          console.log("Using legal basis for step 9:", window.selectedLegalBasis);
          
          // Update current step
          currentStep = 9;
          
          // Call showStep with specific handling for step 9
          showStep(9);
          
          console.log("Transition complete, now on step 9 with legal basis:", window.selectedLegalBasis);
        } catch (error) {
          console.error("Error in goToStep9FromStep8:", error);
          alert("WystÄ…piÅ‚ bÅ‚Ä…d przy przejÅ›ciu do kolejnego kroku. Prosimy odÅ›wieÅ¼yÄ‡ stronÄ™ i sprÃ³bowaÄ‡ ponownie.");
        }
      }

      function updateProgress(step) {
        const progress = (step / totalSteps) * 100;
        const progressBar = document.getElementById('progress');
        if (progressBar) {
          progressBar.style.width = `${progress}%`;
        }
      }

      function validateStep(step) {
        try {
          const stepElement = document.getElementById(`step-${step}`);
          if (!stepElement) return true;

          let isValid = true;
          const errors = [];

          // Get all required fields in the current step
          const requiredFields = stepElement.querySelectorAll('input[required], select[required]');
          
          // Validate each required field
          requiredFields.forEach(field => {
            if (!field.value) {
              field.classList.add('border-red-500');
              errors.push(`Pole ${field.name || 'wymagane'} jest wymagane`);
              isValid = false;
            } else {
              field.classList.remove('border-red-500');
            }
          });

          // Special validation for step 5 (children info)
          if (step === 5) {
            const childForms = document.querySelectorAll('#children-forms > div');
            if (childForms.length === 0) {
              errors.push('ProszÄ™ wybraÄ‡ liczbÄ™ dzieci');
              isValid = false;
            }
          }

          // Special validation for step 11 (email and consent)
          if (step === 11) {
            const email = document.getElementById('final-email')?.value;
            const consentData = document.getElementById('consent-data-processing')?.checked;
            const consentContact = document.getElementById('consent-contact')?.checked;

            if (!email) {
              errors.push('Adres email jest wymagany');
              isValid = false;
            }
            if (!consentData || !consentContact) {
              errors.push('Wymagane jest wyraÅ¼enie wszystkich zgÃ³d');
              isValid = false;
            }
          }

          if (!isValid) {
            alert(errors.join('\n'));
          }

          return isValid;
        } catch (error) {
          console.error('Error in validateStep:', error);
          return false;
        }
      }

      function nextStep() {
        try {
          if (!validateStep(currentStep)) {
            alert('ProszÄ™ wypeÅ‚niÄ‡ wszystkie wymagane pola przed przejÅ›ciem dalej.');
            return;
          }

          // Get next step based on current step and conditions
          let nextStepNumber;
          const flow = stepFlow[currentStep];
          
          if (typeof flow.next === 'function') {
            if (currentStep === 2) {
              nextStepNumber = flow.next(selectedPath);
            } else if (currentStep === 5) {
              const careType = document.querySelector('select[name="care_type"]')?.value;
              nextStepNumber = flow.next(careType);
            } else {
              nextStepNumber = flow.next(currentStep);
            }
          } else {
            nextStepNumber = flow.next;
          }

          // If we're on step 4 (legal basis) and about to go to another step,
          // store the legal basis for later use in step 9
          if (currentStep === 4) {
            window.selectedLegalBasis = document.querySelector('input[name="legal-basis"]:checked')?.value;
            console.log("Stored legal basis:", window.selectedLegalBasis);
            
            // Check if a valid legal basis was selected
            if (!window.selectedLegalBasis) {
              alert('ProszÄ™ wybraÄ‡ podstawÄ™ prawnÄ… przed przejÅ›ciem dalej.');
              return;
            }
          }

          if (nextStepNumber) {
            // If the next step is step 9, use the special function
            if (nextStepNumber === 9) {
              console.log("Using special function to transition to step 9");
              goToStep9FromStep8();
              return;
            }
            
            showStep(nextStepNumber);
          }
        } catch (error) {
          console.error('Error in nextStep:', error);
        }
      }

      function prevStep() {
        try {
          const flow = stepFlow[currentStep];
          if (flow && flow.prev) {
            const prevStepNumber = typeof flow.prev === 'function' ? flow.prev(currentStep) : flow.prev;
            if (prevStepNumber) {
              showStep(prevStepNumber);
            }
          }
        } catch (error) {
          console.error('Error in prevStep:', error);
        }
      }

      function handlePathSelection(radio) {
        selectedPath = radio.value;
        const nextButton = document.getElementById("path-next");
        if (nextButton) {
          nextButton.disabled = false;
        }
      }

      function generateChildForms(count) {
        const container = document.getElementById("children-forms");
        if (!container) return;

        container.innerHTML = "";
        if (count === "5") count = 5;

        for (let i = 1; i <= count; i++) {
          const childForm = document.createElement('div');
          childForm.className = 'p-4 border-2 border-gray-200 rounded-lg mb-4';
          childForm.innerHTML = `
            <h3 className="font-semibold mb-3">Dziecko ${i}</h3>
            <div className="space-y-3">
              <div>
                <label className="block text-gray-700 mb-2">Rok urodzenia dziecka
                  <span className="tooltip">
                    <span className="info-icon">i</span>
                    <span className="tooltiptext">Wiek dziecka wpÅ‚ywa na ocenÄ™ adekwatnoÅ›ci kosztÃ³w i stopnia zaangaÅ¼owania opiekuÅ„czego.</span>
                  </span>
                </label>
                <input type="number" className="w-full p-3 border-2 border-gray-200 rounded-lg" 
                       placeholder="RRRR" min="1900" max="${new Date().getFullYear()}" required>
              </div>
              <div>
                <label className="block text-gray-700 mb-2">Czy dziecko uczÄ™szcza do placÃ³wki edukacyjnej?</label>
                     <span className="tooltip">
                    <span className="info-icon">i</span>
                    <span className="tooltiptext">PamiÄ™taj, by uwzglÄ™dniÄ‡ koszty edukacji w sekcji dotyczÄ…cej wydatkÃ³w.</span>
                  </span>
                <select className="w-full p-3 border-2 border-gray-200 rounded-lg" required>
                  <option value="">Wybierz...</option>
                  <option value="dom">Nie â€“ dziecko przebywa gÅ‚Ã³wnie w domu</option>
                  <option value="zlobek">Tak: Å»Å‚obek</option>
                  <option value="przedszkole">Tak: Przedszkole</option>
                  <option value="podstawowa">Tak: SzkoÅ‚a podstawowa</option>
                  <option value="ponadpodstawowa">Tak: SzkoÅ‚a ponadpodstawowa</option>
                </select>
      
              </div>
              <div>
                <label className="block text-gray-700 mb-2">SposÃ³b sprawowania opieki</label>
                                        <span className="tooltip">
                    <span className="info-icon">i</span>
                    <span className="tooltiptext"> JeÅ›li wybierzesz â€Inny ukÅ‚adâ€, przejdziesz do formularza, ktÃ³ry pomoÅ¼e okreÅ›liÄ‡ procentowy podziaÅ‚ opieki na podstawie rzeczywistego czasu spÄ™dzanego z dzieckiem.</span>
                  </span>
                <select className="w-full p-3 border-2 border-gray-200 rounded-lg" name="care_type" required>
                  <option value="">Wybierz...</option>
                  <option value="naprzemienna">Opieka naprzemienna (50/50)</option>
                  <option value="inny_uklad">Inny ukÅ‚ad â€“ np. dziecko przebywa wiÄ™kszoÅ›Ä‡ czasu u jednego z rodzicÃ³w</option>
                </select>
              </div>
            </div>
          `;
          container.appendChild(childForm);
        }

        // Reinitialize tooltips after adding new elements
        initializeTooltips();
      }

      function initializeTooltips() {
        document.querySelectorAll('.info-icon').forEach(icon => {
          icon.addEventListener('click', function(e) {
            e.stopPropagation();
            const tooltip = this.nextElementSibling;
            if (tooltip) {
              // Close all other tooltips first
              document.querySelectorAll('.tooltiptext, .tooltiptext-wide').forEach(t => {
                if (t !== tooltip) t.classList.remove('active');
              });
              
              tooltip.classList.add('active');
              
              // Add close button if not exists
              if (!tooltip.querySelector('.close-tooltip')) {
                const closeBtn = document.createElement('span');
                closeBtn.className = 'close-tooltip';
                closeBtn.innerHTML = 'Ã—';
                closeBtn.onclick = function(e) {
                  e.stopPropagation();
                  tooltip.classList.remove('active');
                };
                tooltip.appendChild(closeBtn);
              }
            }
          });
        });

        // Close tooltips when clicking outside
        document.addEventListener('click', function(e) {
          if (!e.target.closest('.tooltip')) {
            document.querySelectorAll('.tooltiptext, .tooltiptext-wide').forEach(tooltip => {
              tooltip.classList.remove('active');
            });
          }
        });
      }

      // Initialize the form
      document.addEventListener('DOMContentLoaded', function() {
        showStep(1);
        initializeTooltips();
        
        // Add listeners to legal basis radio buttons
        document.querySelectorAll('input[name="legal-basis"]').forEach(radio => {
          radio.addEventListener('change', function() {
            console.log("Legal basis changed to:", this.value);
            window.selectedLegalBasis = this.value;
            
            // If we're on step 9, update the display immediately
            if (currentStep === 9) {
              console.log("Currently on step 9, updating display...");
              handleStep9Variants();
            }
          });
        });
      });

      // Form submission functions
      function finishForm() {
        if (!validateStep(currentStep)) {
          alert('ProszÄ™ wypeÅ‚niÄ‡ wszystkie wymagane pola i wyraziÄ‡ zgody przed zakoÅ„czeniem.');
          return;
        }

        const email = document.getElementById('final-email').value;
        const consentData = document.getElementById('consent-data-processing').checked;
        const consentContact = document.getElementById('consent-contact').checked;

        if (!email || !consentData || !consentContact) {
          alert('ProszÄ™ wypeÅ‚niÄ‡ wszystkie wymagane pola i wyraziÄ‡ zgody przed zakoÅ„czeniem.');
          return;
        }

        // Generate a random submission ID
        const submissionId = 'AM-' + Math.random().toString(36).substr(2, 9).toUpperCase();
        document.getElementById('submission-id').textContent = submissionId;

        // Move to thank you step
        currentStep = 12;
        showStep(currentStep);
      }

      function finishAlternative() {
        const email = document.querySelector('#step-3b input[type="email"]').value;
        const consent = document.querySelector('#step-3b input[type="checkbox"]').checked;

        if (!email || !consent) {
          alert('ProszÄ™ wypeÅ‚niÄ‡ wszystkie wymagane pola i wyraziÄ‡ zgodÄ™ przed zakoÅ„czeniem.');
          return;
        }

        // Generate a random submission ID
        const submissionId = 'AM-' + Math.random().toString(36).substr(2, 9).toUpperCase();
        document.getElementById('submission-id').textContent = submissionId;

        // Move to thank you step
        currentStep = 12;
        showStep(currentStep);
      }

      function resetForm() {
        // Reset all form fields
        document.querySelectorAll('input[type="text"], input[type="email"], input[type="number"], input[type="date"], select').forEach(input => {
          input.value = '';
          input.classList.remove('border-red-500');
        });
        document.querySelectorAll('input[type="checkbox"], input[type="radio"]').forEach(input => {
          input.checked = false;
        });

        // Reset to first step
        currentStep = 1;
        selectedPath = "";
        showStep(currentStep);
      }

      function copySubmissionId() {
        const submissionId = document.getElementById('submission-id').textContent;
        navigator.clipboard.writeText(submissionId).then(() => {
          alert('ID zgÅ‚oszenia zostaÅ‚o skopiowane do schowka!');
        }).catch(err => {
          console.error('Nie udaÅ‚o siÄ™ skopiowaÄ‡ ID:', err);
        });
      }

      // Form data handling
      function saveFormData() {
        const currentStepElement = document.getElementById(`step-${currentStep}`);
        if (!currentStepElement) return;

        // Get all form elements in current step
        const formElements = currentStepElement.querySelectorAll('input, select, textarea');
        formElements.forEach(element => {
          if (element.name) {
            if (element.type === 'checkbox' || element.type === 'radio') {
              formData[element.name] = element.checked;
            } else {
              formData[element.name] = element.value;
            }
          }
        });
      }

      function loadFormData() {
        const currentStepElement = document.getElementById(`step-${currentStep}`);
        if (!currentStepElement) return;

        // Restore form data for current step
        const formElements = currentStepElement.querySelectorAll('input, select, textarea');
        formElements.forEach(element => {
          if (element.name && formData[element.name] !== undefined) {
            if (element.type === 'checkbox' || element.type === 'radio') {
              element.checked = formData[element.name];
            } else {
              element.value = formData[element.name];
            }
          }
        });
      }

      // Enhanced validation
      function validateEmail(email) {
        const re = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
        return re.test(email);
      }

      function validateNumber(value, min, max) {
        const num = parseFloat(value);
        return !isNaN(num) && num >= min && num <= max;
      }

      function validateStep(step) {
        try {
          const stepElement = document.getElementById(`step-${step}`);
          if (!stepElement) return true;

          let isValid = true;
          const errors = [];

          // Get all required fields in the current step
          const requiredFields = stepElement.querySelectorAll('input[required], select[required]');
          
          // Validate each required field
          requiredFields.forEach(field => {
            if (!field.value) {
              field.classList.add('border-red-500');
              errors.push(`Pole ${field.name || 'wymagane'} jest wymagane`);
              isValid = false;
            } else {
              field.classList.remove('border-red-500');
            }
          });

          // Special validation for step 5 (children info)
          if (step === 5) {
            const childForms = document.querySelectorAll('#children-forms > div');
            if (childForms.length === 0) {
              errors.push('ProszÄ™ wybraÄ‡ liczbÄ™ dzieci');
              isValid = false;
            }
          }

          // Special validation for step 11 (email and consent)
          if (step === 11) {
            const email = document.getElementById('final-email')?.value;
            const consentData = document.getElementById('consent-data-processing')?.checked;
            const consentContact = document.getElementById('consent-contact')?.checked;

            if (!email) {
              errors.push('Adres email jest wymagany');
              isValid = false;
            }
            if (!consentData || !consentContact) {
              errors.push('Wymagane jest wyraÅ¼enie wszystkich zgÃ³d');
              isValid = false;
            }
          }

          if (!isValid) {
            alert(errors.join('\n'));
          }

          return isValid;
        } catch (error) {
          console.error('Error in validateStep:', error);
          return false;
        }
      }

      function nextStep() {
        try {
          // Save current step data
          saveFormData();

          if (!validateStep(currentStep)) {
            return;
          }

          // Get next step based on current step and conditions
          let nextStepNumber;
          const flow = stepFlow[currentStep];
          
          if (typeof flow.next === 'function') {
            if (currentStep === 2) {
              nextStepNumber = flow.next(selectedPath);
            } else if (currentStep === 5) {
              const careType = document.querySelector('select[name="care_type"]')?.value;
              nextStepNumber = flow.next(careType);
            } else {
              nextStepNumber = flow.next(currentStep);
            }
          } else {
            nextStepNumber = flow.next;
          }

          if (nextStepNumber) {
            showStep(nextStepNumber);
            // Load saved data for the new step
            loadFormData();
          }
        } catch (error) {
          console.error('Error in nextStep:', error);
        }
      }

      function prevStep() {
        try {
          // Save current step data
          saveFormData();

          const flow = stepFlow[currentStep];
          if (flow && flow.prev) {
            const prevStepNumber = typeof flow.prev === 'function' ? flow.prev(currentStep) : flow.prev;
            if (prevStepNumber) {
              showStep(prevStepNumber);
              // Load saved data for the previous step
              loadFormData();
            }
          }
        } catch (error) {
          console.error('Error in prevStep:', error);
        }
      }

      function handlePathSelection(radio) {
        selectedPath = radio.value;
        const nextButton = document.getElementById("path-next");
        if (nextButton) {
          nextButton.disabled = false;
        }
      }

      function generateChildForms(count) {
        const container = document.getElementById("children-forms");
        if (!container) return;

        container.innerHTML = "";
        if (count === "5") count = 5;

        for (let i = 1; i <= count; i++) {
          const childForm = document.createElement('div');
          childForm.className = 'p-4 border-2 border-gray-200 rounded-lg mb-4';
          childForm.innerHTML = `
          <h3 className="font-semibold mb-3">Dziecko ${i}</h3>
            <div className="space-y-3">
              <div>
                <label className="block text-gray-700 mb-2">Rok urodzenia dziecka
                  <span className="tooltip">
                    <span className="info-icon">i</span>
                    <span className="tooltiptext">Wiek dziecka wpÅ‚ywa na ocenÄ™ adekwatnoÅ›ci kosztÃ³w i stopnia zaangaÅ¼owania opiekuÅ„czego.</span>
                  </span>
                </label>
                <input type="number" className="w-full p-3 border-2 border-gray-200 rounded-lg" 
                       placeholder="RRRR" min="1900" max="${new Date().getFullYear()}" required>
              </div>
              <div>
                <label className="block text-gray-700 mb-2">Czy dziecko uczÄ™szcza do placÃ³wki edukacyjnej?</label>
                     <span className="tooltip">
                    <span className="info-icon">i</span>
                    <span className="tooltiptext">PamiÄ™taj, by uwzglÄ™dniÄ‡ koszty edukacji w sekcji dotyczÄ…cej wydatkÃ³w.</span>
                  </span>
                <select className="w-full p-3 border-2 border-gray-200 rounded-lg" required>
                  <option value="">Wybierz...</option>
                  <option value="dom">Nie â€“ dziecko przebywa gÅ‚Ã³wnie w domu</option>
                  <option value="zlobek">Tak: Å»Å‚obek</option>
                  <option value="przedszkole">Tak: Przedszkole</option>
                  <option value="podstawowa">Tak: SzkoÅ‚a podstawowa</option>
                  <option value="ponadpodstawowa">Tak: SzkoÅ‚a ponadpodstawowa</option>
                </select>
      
              </div>
              <div>
                <label className="block text-gray-700 mb-2">SposÃ³b sprawowania opieki</label>
                                        <span className="tooltip">
                    <span className="info-icon">i</span>
                    <span className="tooltiptext"> JeÅ›li wybierzesz â€Inny ukÅ‚adâ€, przejdziesz do formularza, ktÃ³ry pomoÅ¼e okreÅ›liÄ‡ procentowy podziaÅ‚ opieki na podstawie rzeczywistego czasu spÄ™dzanego z dzieckiem.</span>
                  </span>
                <select className="w-full p-3 border-2 border-gray-200 rounded-lg" name="care_type" required>
                  <option value="">Wybierz...</option>
                  <option value="naprzemienna">Opieka naprzemienna (50/50)</option>
                  <option value="inny_uklad">Inny ukÅ‚ad â€“ np. dziecko przebywa wiÄ™kszoÅ›Ä‡ czasu u jednego z rodzicÃ³w</option>
                </select>
              </div>
            </div>
          `;
          container.appendChild(childForm);
        }

        // Reinitialize tooltips after adding new elements
        initializeTooltips();
      }

      function initializeTooltips() {
        document.querySelectorAll('.info-icon').forEach(icon => {
          icon.addEventListener('click', function(e) {
            e.stopPropagation();
            const tooltip = this.nextElementSibling;
            if (tooltip) {
              // Close all other tooltips first
              document.querySelectorAll('.tooltiptext, .tooltiptext-wide').forEach(t => {
                if (t !== tooltip) t.classList.remove('active');
              });
              
              tooltip.classList.add('active');
              
              // Add close button if not exists
              if (!tooltip.querySelector('.close-tooltip')) {
                const closeBtn = document.createElement('span');
                closeBtn.className = 'close-tooltip';
                closeBtn.innerHTML = 'Ã—';
                closeBtn.onclick = function(e) {
                  e.stopPropagation();
                  tooltip.classList.remove('active');
                };
                tooltip.appendChild(closeBtn);
              }
            }
          });
        });

        // Close tooltips when clicking outside
        document.addEventListener('click', function(e) {
          if (!e.target.closest('.tooltip')) {
            document.querySelectorAll('.tooltiptext, .tooltiptext-wide').forEach(tooltip => {
              tooltip.classList.remove('active');
            });
          }
        });
      }

      // Initialize the form
      document.addEventListener('DOMContentLoaded', function() {
        showStep(1);
        initializeTooltips();
        
        // Add listeners to legal basis radio buttons
        document.querySelectorAll('input[name="legal-basis"]').forEach(radio => {
          radio.addEventListener('change', function() {
            console.log("Legal basis changed to:", this.value);
            window.selectedLegalBasis = this.value;
            
            // If we're on step 9, update the display immediately
            if (currentStep === 9) {
              console.log("Currently on step 9, updating display...");
              handleStep9Variants();
            }
          });
        });
      });

      // Form submission functions
      function finishForm() {
        if (!validateStep(currentStep)) {
          alert('ProszÄ™ wypeÅ‚niÄ‡ wszystkie wymagane pola i wyraziÄ‡ zgody przed zakoÅ„czeniem.');
          return;
        }

        const email = document.getElementById('final-email').value;
        const consentData = document.getElementById('consent-data-processing').checked;
        const consentContact = document.getElementById('consent-contact').checked;

        if (!email || !consentData || !consentContact) {
          alert('ProszÄ™ wypeÅ‚niÄ‡ wszystkie wymagane pola i wyraziÄ‡ zgody przed zakoÅ„czeniem.');
          return;
        }

        // Generate a random submission ID
        const submissionId = 'AM-' + Math.random().toString(36).substr(2, 9).toUpperCase();
        document.getElementById('submission-id').textContent = submissionId;

        // Move to thank you step
        currentStep = 12;
        showStep(currentStep);
      }

      function finishAlternative() {
        const email = document.querySelector('#step-3b input[type="email"]').value;
        const consent = document.querySelector('#step-3b input[type="checkbox"]').checked;

        if (!email || !consent) {
          alert('ProszÄ™ wypeÅ‚niÄ‡ wszystkie wymagane pola i wyraziÄ‡ zgodÄ™ przed zakoÅ„czeniem.');
          return;
        }

        // Generate a random submission ID
        const submissionId = 'AM-' + Math.random().toString(36).substr(2, 9).toUpperCase();
        document.getElementById('submission-id').textContent = submissionId;

        // Move to thank you step
        currentStep = 12;
        showStep(currentStep);
      }

      function resetForm() {
        // Reset all form fields
        document.querySelectorAll('input[type="text"], input[type="email"], input[type="number"], input[type="date"], select').forEach(input => {
          input.value = '';
          input.classList.remove('border-red-500');
        });
        document.querySelectorAll('input[type="checkbox"], input[type="radio"]').forEach(input => {
          input.checked = false;
        });

        // Reset to first step
        currentStep = 1;
        selectedPath = "";
        showStep(currentStep);
      }

      function copySubmissionId() {
        const submissionId = document.getElementById('submission-id').textContent;
        navigator.clipboard.writeText(submissionId).then(() => {
          alert('ID zgÅ‚oszenia zostaÅ‚o skopiowane do schowka!');
        }).catch(err => {
          console.error('Nie udaÅ‚o siÄ™ skopiowaÄ‡ ID:', err);
        });
      }

      // Form data handling
      function saveFormData() {
        const currentStepElement = document.getElementById(`step-${currentStep}`);
        if (!currentStepElement) return;

        // Get all form elements in current step
        const formElements = currentStepElement.querySelectorAll('input, select, textarea');
        formElements.forEach(element => {
          if (element.name) {
            if (element.type === 'checkbox' || element.type === 'radio') {
              formData[element.name] = element.checked;
            } else {
              formData[element.name] = element.value;
            }
          }
        });
      }

      function loadFormData() {
        const currentStepElement = document.getElementById(`step-${currentStep}`);
        if (!currentStepElement) return;

        // Restore form data for current step
        const formElements = currentStepElement.querySelectorAll('input, select, textarea');
        formElements.forEach(element => {
          if (element.name && formData[element.name] !== undefined) {
            if (element.type === 'checkbox' || element.type === 'radio') {
              element.checked = formData[element.name];
            } else {
              element.value = formData[element.name];
            }
          }
        });
      }

      // Enhanced validation
      function validateEmail(email) {
        const re = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
        return re.test(email);
      }

      function validateNumber(value, min, max) {
        const num = parseFloat(value);
        return !isNaN(num) && num >= min && num <= max;
      }

      function validateStep(step) {
        try {
          const stepElement = document.getElementById(`step-${step}`);
          if (!stepElement) return true;

          let isValid = true;
          const errors = [];

          // Get all required fields in the current step
          const requiredFields = stepElement.querySelectorAll('input[required], select[required]');
          
          // Validate each required field
          requiredFields.forEach(field => {
            if (!field.value) {
              field.classList.add('border-red-500');
              errors.push(`Pole ${field.name || 'wymagane'} jest wymagane`);
              isValid = false;
            } else {
              field.classList.remove('border-red-500');
            }
          });

          // Special validation for step 5 (children info)
          if (step === 5) {
            const childForms = document.querySelectorAll('#children-forms > div');
            if (childForms.length === 0) {
              errors.push('ProszÄ™ wybraÄ‡ liczbÄ™ dzieci');
              isValid = false;
            }
          }

          // Special validation for step 11 (email and consent)
          if (step === 11) {
            const email = document.getElementById('final-email')?.value;
            const consentData = document.getElementById('consent-data-processing')?.checked;
            const consentContact = document.getElementById('consent-contact')?.checked;

            if (!email) {
              errors.push('Adres email jest wymagany');
              isValid = false;
            }
            if (!consentData || !consentContact) {
              errors.push('Wymagane jest wyraÅ¼enie wszystkich zgÃ³d');
              isValid = false;
            }
          }

          if (!isValid) {
            alert(errors.join('\n'));
          }

          return isValid;
        } catch (error) {
          console.error('Error in validateStep:', error);
          return false;
        }
      }

      function nextStep() {
        try {
          // Save current step data
          saveFormData();

          if (!validateStep(currentStep)) {
            return;
          }

          // Get next step based on current step and conditions
          let nextStepNumber;
          const flow = stepFlow[currentStep];
          
          if (typeof flow.next === 'function') {
            if (currentStep === 2) {
              nextStepNumber = flow.next(selectedPath);
            } else if (currentStep === 5) {
              const careType = document.querySelector('select[name="care_type"]')?.value;
              nextStepNumber = flow.next(careType);
            } else {
              nextStepNumber = flow.next(currentStep);
            }
          } else {
            nextStepNumber = flow.next;
          }

          if (nextStepNumber) {
            showStep(nextStepNumber);
            // Load saved data for the new step
            loadFormData();
          }
        } catch (error) {
          console.error('Error in nextStep:', error);
        }
      }

      function prevStep() {
        try {
          // Save current step data
          saveFormData();

          const flow = stepFlow[currentStep];
          if (flow && flow.prev) {
            const prevStepNumber = typeof flow.prev === 'function' ? flow.prev(currentStep) : flow.prev;
            if (prevStepNumber) {
              showStep(prevStepNumber);
              // Load saved data for the previous step
              loadFormData();
            }
          }
        } catch (error) {
          console.error('Error in prevStep:', error);
        }
      }

      function handlePathSelection(radio) {
        selectedPath = radio.value;
        const nextButton = document.getElementById("path-next");
        if (nextButton) {
          nextButton.disabled = false;
        }
      }
      function nextStep() {
  try {
    // Save current step data
    saveFormData();

    // PrzewiÅ„ na gÃ³rÄ™ *przed* pokazaniem nastÄ™pnego kroku
    window.scrollTo(0, 0);

    const flow = stepFlow[currentStep];
    if (flow && flow.next) {
      let nextStepNumber;
      if (typeof flow.next === 'function') {
        if (currentStep === 2) {
          nextStepNumber = flow.next(selectedPath);
        } else if (currentStep === 5) {
          const careType = document.querySelector('select[name="care_type"]')?.value;
          nextStepNumber = flow.next(careType);
        } else {
          nextStepNumber = flow.next(currentStep);
        }
      } else {
        nextStepNumber = flow.next;
      }

      if (nextStepNumber) {
        showStep(nextStepNumber);
        // Load saved data for the new step
        loadFormData();
      }
    }
  } catch (error) {
    console.error('Error in nextStep:', error);
  }
}

function prevStep() {
  try {
    // Save current step data
    saveFormData();

    // PrzewiÅ„ na gÃ³rÄ™ *przed* pokazaniem poprzedniego kroku
    window.scrollTo(0, 0);

    const flow = stepFlow[currentStep];
    if (flow && flow.prev) {
      const prevStepNumber = typeof flow.prev === 'function' ? flow.prev(currentStep) : flow.prev;
      if (prevStepNumber) {
        showStep(prevStepNumber);
        // Load saved data for the previous step
        loadFormData();
      }
    }
  } catch (error) {
    console.error('Error in prevStep:', error);
  }
}


// Naprawione dziaÅ‚anie tooltipÃ³w
document.addEventListener('DOMContentLoaded', function() {
  // CaÅ‚kowicie nowa inicjalizacja tooltipÃ³w
  function fixAllTooltips() {
    // Najpierw usuÅ„ wszystkie istniejÄ…ce listenery z ikon info
    document.querySelectorAll('.info-icon').forEach(icon => {
      const newIcon = icon.cloneNode(true);
      if (icon.parentNode) {
        icon.parentNode.replaceChild(newIcon, icon);
      }
    });
    
    // Teraz dodaj nowe listenery z izolacjÄ… zdarzeÅ„
    document.querySelectorAll('.info-icon').forEach(icon => {
      icon.addEventListener('click', function(e) {
        e.preventDefault();
        e.stopPropagation();
        
        const tooltip = this.nextElementSibling;
        if (!tooltip) return;
        
        console.log('Tooltip clicked:', tooltip);
        
        // Zamknij wszystkie inne tooltipy
        document.querySelectorAll('.tooltiptext, .tooltiptext-wide').forEach(t => {
          if (t !== tooltip) {
            t.classList.remove('active');
            const closeBtn = t.querySelector('.close-tooltip');
            if (closeBtn) closeBtn.remove();
          }
        });
        
        // PrzeÅ‚Ä…cz widocznoÅ›Ä‡ tego tooltipu
        tooltip.classList.toggle('active');
        
        // Dodaj przycisk zamkniÄ™cia jeÅ›li tooltip jest aktywny i jeszcze go nie ma
        if (tooltip.classList.contains('active') && !tooltip.querySelector('.close-tooltip')) {
          const closeBtn = document.createElement('span');
          closeBtn.className = 'close-tooltip';
          closeBtn.innerHTML = 'Ã—';
          closeBtn.onclick = function(evt) {
            evt.preventDefault();
            evt.stopPropagation();
            tooltip.classList.remove('active');
          };
          tooltip.appendChild(closeBtn);
        }
      });
    });
    
    // Dodaj rÃ³wnieÅ¼ obsÅ‚ugÄ™ klikniÄ™cia poza tooltipem aby go zamknÄ…Ä‡
    document.addEventListener('click', function(e) {
      // JeÅ›li klikniÄ™cie nie dotyczy elementu tooltip ani ikony info
      if (!e.target.closest('.tooltiptext') && 
          !e.target.closest('.tooltiptext-wide') && 
          !e.target.matches('.info-icon')) {
        document.querySelectorAll('.tooltiptext, .tooltiptext-wide').forEach(tooltip => {
          tooltip.classList.remove('active');
          const closeBtn = tooltip.querySelector('.close-tooltip');
          if (closeBtn) closeBtn.remove();
        });
      }
    }, { capture: true });
  }
  
  // WywoÅ‚aj naprawÄ™ tooltipÃ³w po zaÅ‚adowaniu strony
  fixAllTooltips();
  
  // ZastÄ…p oryginalnÄ… funkcjÄ™ naszÄ… naprawionÄ… wersjÄ…
  window.initializeTooltips = fixAllTooltips;
  
  // Napraw showStep aby reinicjalizowaÅ‚ tooltipy
  const originalShowStep = window.showStep;
  window.showStep = function(step) {
    if (originalShowStep) {
      originalShowStep(step);
    }
    
    // Poczekaj aÅ¼ DOM siÄ™ zaktualizuje i napraw tooltipy
    setTimeout(fixAllTooltips, 200);
  };
  
  // Napraw generateChildForms aby reinicjalizowaÅ‚ tooltipy
  const originalGenerateChildForms = window.generateChildForms;
  window.generateChildForms = function(count) {
    if (originalGenerateChildForms) {
      originalGenerateChildForms(count);
    }
    
    // Poczekaj aÅ¼ DOM siÄ™ zaktualizuje i napraw tooltipy
    setTimeout(fixAllTooltips, 200);
  };
  
  // Upewnij siÄ™, Å¼e klikniÄ™cie w div.tooltip nie propaguje siÄ™ do elementu label
  document.querySelectorAll('.tooltip').forEach(tooltip => {
    tooltip.addEventListener('click', function(e) {
      e.stopPropagation();
    });
  });
});
    </script>
  </body>
</html>
